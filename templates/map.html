{% load static %}
<!DOCTYPE html>
<html lang="en">

<!--head start-->

<head>
    <!--meta tag start-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--title-->
    <title>Bipad</title>

    <!-- faveicon start   -->
    <link rel="icon" type="image/png" href="{% static 'mappage/images/favicon.png' %}" sizes="32x32">

    <!-- stylesheet start -->

    <!-- <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/bootstrap.min.css' %}"> -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/customfonts.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/ionicons.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/select2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/c3.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
        integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/leaflet.draw.css' %}">

    <link rel="stylesheet" type="text/css" href="{% static 'mappage/css/nouislider.min.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />

    <style>

    </style>
</head>
<!--head end-->

<body>
    <!-- bipad start -->
    <div class="bipadContent">

        <!-- mapsection start -->
        <div class="mapwrap">

            <!-- logo start -->
            <div class="bipad-logo">
                <h1 class="logo"><a href="index.html">Bipad</a></h1>
                <h3 class="admin-level">National</h3>
                <span class="sub-logo">RiskInfo</span>

            </div>

            <div class="loader">
                <div class="spinner-border"></div><span id="loader_text">Loading Data</span>
            </div>
            <!-- map start -->
            <div id="mapid"></div>

            <!-- right navigation -->
            <!-- <div class="right-nav">
                <div class="nav-wrap">
                    <ul>
                        <li><a href="#"><i class="ion ion-md-home"></i><span>Dashboard</span></a></li>
                        <li><a href="#"><i class="ion ion-ios-warning"></i><span>Incidents</span></a></li>
                        <li class="active"><a href="#"><i class="ion ion-ios-map"></i><span>Risk information</span></a></li>
                        <li><a href="#"><i class="ion ion-md-alarm"></i><span>Loss & Damage</span></a></li>
                        <li><a href="#"><i class="ion ion-ios-stopwatch"></i><span>Real Time</span></a></li>
                        <li><a href="#"><i class="ion ion-md-briefcase"></i><span>profile mapping</span></a></li>
                        <li><a href="#"><i class="ion ion-md-information-circle"></i><span>about us</span></a></li>
                    </ul>

                </div>
                <div class="buffer-icon">
                    <span class="ion ion-logo-buffer"></span>
                </div>
            </div> -->


            <div class="expand-layer">
                <span class="expand-icon" id="flood-expand">
                    <i class="ion ion-md-funnel"></i>
                </span>
                <span class="expand-icon" id="capacity-expand">
                    <i class="ion ion-md-funnel"></i>
                </span>
                <span class="expand-icon" id="vulnery-expand">
                    <i class="ion ion-md-funnel"></i>
                </span>
            </div>
            <!-- map layer list -->
            <div class="buffer-list">
                <div class="buffer-wrapper">
                    <div class="buffer-header">
                        <h4>Maplayer</h4>
                        <span><i class="ion ion-md-close"></i></span>
                    </div>
                    <ul>
                        <li class="light"><a href="#">Light</a></li>
                        <li class="street"><a href="#">street</a></li>
                        <li class="outdoor"><a href="#">outdoor</a></li>
                        <li class="satelite"><a href="#">satelite</a></li>
                        <li class="road"><a href="#">Roads</a></li>
                    </ul>
                </div>
            </div>
            <!-- legend layer list -->
            <div class="legend-list">
                <!-- <div class="legend-wrapper">
                    <div class="buffer-header">
                        <h4>Legend</h4>
                        <span><i class="ion ion-md-close"></i></span>
                    </div>
                    <ul>
                        <li class="light"><a href="#">Light</a></li>
                        <li class="street"><a href="#">street</a></li>
                        <li class="outdoor"><a href="#">outdoor</a></li>
                        <li class="satelite"><a href="#">satelite</a></li>
                        <li class="road"><a href="#">Roads</a></li>
                    </ul>
                </div> -->


            </div>

            <!-- leftSidebar start -->


            <!-- <div class="sidebar leftSidebar" id="filtered_layer_list_container" style="display:block;">

              <div class="leftSidebar-header">
                  <h4>Incidents</h4>
              </div>
              <ul class="list-content" id='filtered_layer_list'>

              </ul>

            </div> -->

            <div class="sidebar leftSidebar" style="display:block;">
                <!-- <span class="expand-icon">
                        <i class="ion ion-ios-warning"></i>
                    </span> -->
                <!-- <div class="sidebarwrapper" id="filtered_layer_list_container" style="display:none;">

                      <div class="leftSidebar-header">
                          <h4>Incidents</h4>
                      </div>
                      <ul class="list-content" id='filtered_layer_list'>

                      </ul>

                    </div> -->



                <div class="sidebarwrapper leftsidebarwrapper" style="display:none;">
                    <div class="panel-group">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul id="filtered_layer_list_container" class="panel-title filtered-list-parent">
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- rightSidebar start -->
            <div class=" sidebar rightSidebar">
                <!-- <span class="expand-icon">
                    <i class="ion ion-md-funnel"></i>
                </span> -->
                <div class="sidebarwrapper">
                    <!-- sidebar start -->


                    <div class="sidebar-widget filter-widget" style="display:block;">



                        <div class="right-sidebar-title filter-title">
                            <h4>Filter</h4>
                        </div>
                        <div class="filterSelect">
                            <div class="type-wrap">
                                <input type="text" id="fed_filterInput" placeholder="search" class="form-control" />
                                <span>
                                    <i class="ion ion-md-close filter_close"></i>
                                    <i class="ion ion-md-arrow-dropdown filter_dropdown"></i>
                                </span>

                            </div>
                            <div class="filter-listing">
                                <ul id="federal_boundary">

                                </ul>
                            </div>

                            <!-- <div class="dropdown">
                        <button class="btn-xm dropdown-toggle" type="button" data-toggle="dropdown">select option
                        <span class="caret"></span></button>
                        <ul class="dropdown-menu" id="federal_boundary">
                          <li>HTML</li>

                        </ul>
                        </div> -->

                            <!-- <div class="filterSelect">
                              <h5>Admin level</h5>
                              <ul class="nav nav-tabs" id="myTab" role="tablist">
                                  <li class="nav-item">
                                      <a class="nav-link active" id="province-tab" data-toggle="tab" href="#province" role="tab" aria-controls="province" aria-selected="true">province</a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" id="district-tab" data-toggle="tab" href="#district" role="tab" aria-controls="district" aria-selected="false">District</a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" id="municipality-tab" data-toggle="tab" href="#municipality" role="tab" aria-controls="municipality" aria-selected="false">municipality</a>
                                  </li>
                              </ul>
                              <div class="tab-content" id="myTabContent">
                                  <div class="tab-pane fade show active" id="province" role="tabpanel" aria-labelledby="province-tab">
                                      <h5>Province</h5>
                                      <div class="select-option">
                                          <select class="select2 form-control" name="province">
                                              <option value="pr1">Province-1</option>
                                              <option value="pr2">Province-2</option>
                                              <option value="pr3">Province-3</option>
                                          </select>
                                      </div>
                                  </div>
                                  <div class="tab-pane fade" id="district" role="tabpanel" aria-labelledby="district-tab">
                                      <h5>District</h5>
                                      <div class="select-option">
                                          <select class="select2 form-control" name="Municipality">
                                              <option value="progress_4">kathmandu</option>
                                              <option value="pr5">Pokhara</option>
                                              <option value="pr6">Lalitpur</option>
                                          </select>
                                      </div>
                                  </div>
                                  <div class="tab-pane fade" id="municipality" role="tabpanel" aria-labelledby="municipality-tab">
                                      <h5>municipality</h5>
                                      <div class="select-option">
                                          <select class="select2 form-control" name="District">
                                              <option value="pr1">kathmandu</option>
                                              <option value="pr2">Pokhara</option>
                                              <option value="pr3">Lalitpur</option>
                                          </select>
                                      </div>
                                  </div>
                              </div>
                          </div> -->

                        </div>



                    </div>
                    <div class="hazard-acc">
                        <div id="sidebar-widget">
                            <div class="card">
                                <div class="card-header" id="heading-1">
                                    <h5>
                                        <a class="collapsed updown" role="button" data-toggle="collapse"
                                            href="#collapse-1" aria-expanded="true" aria-controls="collapse-1">Hazard
                                            <i class="ion ion-md-information-circle" data-toggle="popover"
                                                data-trigger="hover" data-placement="left"
                                                data-content="Hazard is a phenomena or event that has the potential to cause damage/disruption to lives and livelihood "></i>

                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse-1" class="collapse show" data-parent="#sidebar-widget"
                                    aria-labelledby="heading-1">
                                    <div class="card-body">
                                        <ul class="list-content hazard-list">

                                            {% for hazard in hazardtype %}
                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input hazard_list"
                                                        hasLayer="false" data-currentLayer="" id="{{ hazard.title }}"
                                                        name="checks" value="customEx">
                                                    <label class="custom-control-label" for="{{ hazard.title }}"
                                                        data-tab="flood-1">{{ hazard.title }} </label>
                                                </div>
                                                <span class={{hazard.hazard_icon}}></span>
                                            </li>
                                            {% endfor %}
                                            <!-- <li>
                        <div class="custom-control custom-radio">
                          <input type="radio" class="custom-control-input hazard_list" id="Earthquake" hasLayer="false"
                            data-currentLayer="" name="checks" value="customEx">
                          <label class="custom-control-label" for="Earthquake" data-tab="flood-1">Earthquake</label>
                        </div>
                        <span class="humanitarian-icon-Earthquake"></span>
                      </li> -->



                                            <!-- <li>

                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="Landslide" name="example1" value="customEx">
                                                    <label class="custom-control-label" for="Landslide">Landslide</label>
                                                </div>
                                                <span class="humanitarian-icon-Landslide-mudslide"></span>
                                            </li>
                                            <li>
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="Fire" name="example1" value="customEx">
                                                    <label class="custom-control-label" for="Fire">Fire</label>
                                                </div>
                                                <span class="humanitarian-icon-Fire"></span>
                                            </li>
                                            <li>
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="Draought" name="example1" value="customEx">
                                                    <label class="custom-control-label" for="Draought">Drought</label>
                                                </div>
                                                <span class="humanitarian-icon-Drought"></span>

                                            </li>

                                            </li> -->

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="heading-2">
                                    <h5>
                                        <a class="collapsed updown" role="button" data-toggle="collapse"
                                            href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">Exposure
                                            <i class="ion ion-md-information-circle" data-toggle="popover"
                                                data-trigger="hover" data-placement="left"
                                                data-content="The situation of people, infrastructure, housing, production capacities and other tangible human assets located in hazard-prone areas"></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse-2" class="collapse" data-parent="#sidebar-widget"
                                    aria-labelledby="heading-2">
                                    <div class="card-body">
                                        <ul class="list-content hazard-list">
                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input exoposure_data_pop"
                                                        data-pop="Drone Imageries" id="OSM" data-currentLayer=""
                                                        name="checks" value="customEx">
                                                    <label class="custom-control-label" data-tab="exposure_popup"
                                                        for="OSM">Drone Imageries
                                                    </label>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input exoposure_data_pop"
                                                        data-pop="Infrastructures" id="Land" data-currentLayer=""
                                                        name="checks" value="customEx">
                                                    <label class="custom-control-label" data-tab="infa_exposure_popup"
                                                        for="Land">Infrastructures</label>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input exoposure_data_pop"
                                                        data-pop="OSM Layers" id="osmLayer" data-currentLayer=""
                                                        name="checks" value="customEx">
                                                    <label class="custom-control-label" data-tab="osmLayer_popup"
                                                        for="osmLayer">OSM
                                                        Layers</label>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="heading-3">
                                    <h5>
                                        <a class="collapsed updown" role="button" data-toggle="collapse"
                                            href="#collapse-3" aria-expanded="false"
                                            aria-controls="collapse-3">Vulnerability
                                            <i class="ion ion-md-information-circle" data-toggle="popover"
                                                data-trigger="hover" data-placement="left"
                                                data-content="The conditions determined by physical, social, economic and environmental factors or processes which increase the susceptibility of an individual, a community, assets or systems to the impacts of hazards."></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse-3" class="collapse" data-parent="#sidebar-widget"
                                    aria-labelledby="heading-3">
                                    <div class="card-body">
                                        <ul class="list-content hazard-list">
                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul" id="HDI"
                                                        data-currentLayer="" data-result="" name="checks"
                                                        value="customEx">
                                                    <label class="custom-control-label" for="HDI" data-tab="hdi_vul">HDI
                                                    </label>
                                                </div>
                                                <span class="humanitarian-icon-Infant"></span>
                                            </li>

                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul"
                                                        id="REMOTE" data-currentLayer="" data-result="" name="checks"
                                                        value="customEx">
                                                    <label class="custom-control-label" for="REMOTE"
                                                        data-tab="remote_vul">Remoteness </label>
                                                </div>
                                                <span class="humanitarian-icon-Monitor"></span>
                                            </li>

                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul" id="PCI"
                                                        data-currentLayer="" data-result="" name="checks"
                                                        value="customEx">
                                                    <label class="custom-control-label" for="PCI" data-tab="pci_vul">Per
                                                        Capita Income </label>
                                                </div>
                                                <span class="humanitarian-icon-warehouse"></span>
                                            </li>


                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul" id="LE"
                                                        data-currentLayer="" data-result="" name="checks"
                                                        value="customEx">
                                                    <label class="custom-control-label" for="LE" data-tab="le_vul">Life
                                                        Expectancy </label>
                                                </div>
                                                <span class="humanitarian-icon-Helipad"></span>
                                            </li>

                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul" id="HPI"
                                                        data-currentLayer="" data-result="" name="checks"
                                                        value="customEx">
                                                    <label class="custom-control-label" for="HPI"
                                                        data-tab="hpi_vul">Human Poverty Index </label>
                                                </div>
                                                <span class="humanitarian-icon-Helipad"></span>
                                            </li>

                                            <li>
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input  parent_vul"
                                                        id="GDP" data-currentLayer="" name="checks" value="customEx">
                                                    <label class="custom-control-label" for="GDP"
                                                        data-tab="vulnery-1">Access To
                                                        Communication</label>
                                                </div>
                                                <span class="humanitarian-icon-Fund"></span>
                                            </li>

                                            <li>
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input  parent_vul"
                                                        id="ATW" data-currentLayer="" name="checks" value="customEx">
                                                    <label class="custom-control-label" for="ATW"
                                                        data-tab="awt_vul">Access To Water</label>
                                                </div>
                                                <span class="humanitarian-icon-Fund"></span>
                                            </li>

                                            <li>
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input  parent_vul"
                                                        id="TOIL" data-currentLayer="" name="checks" value="customEx">
                                                    <label class="custom-control-label" for="TOIL"
                                                        data-tab="toil_vul">Access To Toilet</label>
                                                </div>
                                                <span class="humanitarian-icon-Fund"></span>
                                            </li>

                                            <li>

                                                <!-- <li>

                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="percapital" name="example1" value="customEx">
                                                    <label class="custom-control-label" for="percapital">per capital income</label>
                                                </div>
                                                <span class="humanitarian-icon-Fund"></span>

                                            </li>

                                            </li> -->

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="heading-4">
                                    <h5>
                                        <a class="collapsed updown" role="button" data-toggle="collapse"
                                            href="#collapse-4" aria-expanded="false" aria-controls="collapse-4">Risk
                                            <i class="ion ion-md-information-circle" style="float:right;"
                                                data-toggle="popover" data-trigger="hover" data-placement="left"
                                                data-content=""></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse-4" class="collapse" data-parent="#sidebar-widget"
                                    aria-labelledby="heading-4">
                                    <div class="card-body">
                                        <ul class="list-content hazard-list">
                                            <li class="active">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" class="custom-control-input parent_vul"
                                                        id="earthquake_r" name="checks" value="customEx">
                                                    <label class="custom-control-label" for="earthquake_r"
                                                        data-tab="earthquake_risk">Earthquake
                                                        Risk </label>
                                                </div>
                                                <span class="humanitarian-icon-Hospital"></span>
                                            </li>
                                            <!-- <li>
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox" class="custom-control-input" id="Earthquacke" name="risk" value="customEx">
                                                    <label class="custom-control-label" for="Earthquacke">Flood Risk</label>
                                                </div>
                                                <span class="humanitarian-icon-Education"></span>
                                            </li> -->

                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="heading-5">
                                    <h5>
                                        <a class="collapsed updown" role="button" data-toggle="collapse"
                                            href="#collapse-5" aria-expanded="false" aria-controls="collapse-5">capacity
                                            & resources
                                            <i class="ion ion-md-information-circle" style="float:right;"
                                                data-toggle="popover" data-trigger="hover" data-placement="left"
                                                data-content="The strengths, attributes and resources available within the administrative area to manage and reduce disaster risks and strengthen resilience"></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse-5" class="collapse" data-parent="#sidebar-widget"
                                    aria-labelledby="heading-5">
                                    <div class="card-body">
                                        <ul class="list-content hazard-list">
                                            {% for resource in resources %}
                                            <li>
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                        class="custom-control-input custom-main-input CheckBox {{resource.layername}}_parent"
                                                        value="{{resource.layername}}" data-subcat="{{resource.type}}"
                                                        data-icon={{resource.layer_icon}}
                                                        data-filter="{{resource.filter_options}}"
                                                        data-range="{{resource.filter_range}}"
                                                        data-count="{{resource.count_obj}}"
                                                        id="{{resource.layername}}_id"
                                                        data-url="{{resource.geoserver_url}}"
                                                        data-workspace="{{resource.geoserver_workspace}}">
                                                    <label class="custom-control-label" for="{{resource.layername}}_id"
                                                        data-tab="capacity-popup">{{resource.title}}</label>
                                                </div>
                                                <span class="humanitarian-icon-{{resource.layername}}"></span>
                                            </li>
                                            {% endfor %} {% comment %}
                                            <li class="check-list">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                        class="custom-control-input custom-main-input" id="capacity-2">
                                                    <label class="custom-control-label" for="capacity-2">Health </label>
                                                </div>
                                            </li>
                                            <li class="check-list">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                        class="custom-control-input custom-main-input" id="capacity-3">
                                                    <label class="custom-control-label" for="capacity-3">Health </label>
                                                </div>
                                            </li> {% endcomment %}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- hazarda popup -->
            <div class="hazard-details" data-ex="Flood" id="flood-1">
                <div class="hazard-wrapper trans_constrast" id="hazard_popup_html">
                    <!-- not needed part load from jquery-->
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Flood</h3>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">
                                <div class="card">
                                    <div class="card-header" id="landslide_1">
                                        <h5>
                                            <a class="collapsed updown" role="button" data-toggle="collapse"
                                                href="#landslide_col_1" aria-expanded="true"
                                                aria-controls="landslide_col_1">Karnali
                                                <div class="icon-list">
                                                    <span class="ion ion-md-information-circle"></span>
                                                    <span class="ion ion-md-albums"></span>
                                                    <span class="ion ion-md-contrast"></span>
                                                    <span class="ion ion-md-more">
                                                        <div class="more-list">
                                                            <span class="ion ion-md-cloud-download"></span>
                                                            <span class="ion ion-md-eye"></span>
                                                            <span class="ion ion-md-remove-circle-outline"></span>
                                                        </div>
                                                    </span>
                                                </div>
                                            </a>
                                        </h5>

                                    </div>
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            data-workspace="ngp:flood_karnali_depth_5"
                                                            data-center="[28.491324426181734,81.24904632568361]"
                                                            id="year17" name="year17" value="customEx">
                                                        <label class="custom-control-label" for="year17">5 year </label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year16" data-workspace="ngp:flood_karnali_depth_10"
                                                            data-center="[28.491324426181734,81.24904632568361]"
                                                            name="year17" value="customEx">
                                                        <label class="custom-control-label" for="year16">10 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year15" data-workspace="ngp:flood_karnali_depth_25"
                                                            data-center="[28.491324426181734,81.24904632568361]"
                                                            name="year17" value="customEx">
                                                        <label class="custom-control-label" for="year15">25 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year14" data-workspace="ngp:flood_karnali_depth_50"
                                                            data-center="[28.491324426181734,81.24904632568361]"
                                                            name="year17" value="customEx">
                                                        <label class="custom-control-label" for="year14">50 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year13" data-workspace="ngp:flood_karnali_depth_100"
                                                            data-center="[28.491324426181734,81.24904632568361]"
                                                            name="year17" value="customEx">
                                                        <label class="custom-control-label" for="year13">100
                                                            Year</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-header" id="landslide_2">
                                        <h5>
                                            <a class="collapsed updown" role="button" data-toggle="collapse"
                                                href="#landslide_col_2" aria-expanded="false"
                                                aria-controls="landslide_col_2">Aurahi
                                                <div class="icon-list">
                                                    <span class="ion ion-md-information-circle"></span>
                                                    <span class="ion ion-md-albums"></span>
                                                    <span class="ion ion-md-contrast"></span>
                                                    <span class="ion ion-md-more">
                                                        <div class="more-list">
                                                            <span class="ion ion-md-cloud-download"></span>
                                                            <span class="ion ion-md-eye"></span>
                                                            <span class="ion ion-md-remove-circle-outline"></span>
                                                        </div>
                                                    </span>
                                                </div>
                                            </a>
                                        </h5>

                                    </div>
                                    <div id="landslide_col_2" class="collapse" data-parent="#accordion"
                                        aria-labelledby="landslide_2">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year1" data-workspace="ngp:flood_aurahi_depth_2"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year1">2 Year </label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year2" data-workspace="ngp:flood_aurahi_depth_5"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year2">5 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year3" data-workspace="ngp:flood_aurahi_depth_10"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year3">10 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year4" data-workspace="ngp:flood_aurahi_depth_25"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year4">25 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year5" data-workspace="ngp:flood_aurahi_depth_50"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year5">50 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year6" data-workspace="ngp:flood_aurahi_depth_100"
                                                            name="year1" value="customEx">
                                                        <label class="custom-control-label" for="year6">100 Year</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-header" id="landslide_3">
                                        <h5>
                                            <a class="collapsed updown" role="button" data-toggle="collapse"
                                                href="#landslide_col_3" aria-expanded="false"
                                                aria-controls="landslide_col_3">Banganga
                                                <div class="icon-list">
                                                    <span class="ion ion-md-information-circle"></span>
                                                    <span class="ion ion-md-albums"></span>
                                                    <span class="ion ion-md-contrast"></span>
                                                    <span class="ion ion-md-more">
                                                        <div class="more-list">
                                                            <span class="ion ion-md-cloud-download"></span>
                                                            <span class="ion ion-md-eye"></span>
                                                            <span class="ion ion-md-remove-circle-outline"></span>
                                                        </div>
                                                    </span>
                                                </div>
                                            </a>
                                        </h5>
                                    </div>
                                    <div id="landslide_col_3" class="collapse" data-parent="#accordion"
                                        aria-labelledby="landslide_3">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year7" data-workspace="ngp:ngp:flood_banganga_depth_2"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year7">2 Year </label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year8" data-workspace="ngp:flood_banganga_depth_5"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year8">5 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year9" data-workspace="ngp:flood_banganga_depth_10"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year9">10 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year10" data-workspace="ngp:flood_banganga_depth_25"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year10">25 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year11" data-workspace="ngp:flood_banganga_depth_50"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year11">50 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input hazard_geo"
                                                            id="year12" data-workspace="ngp:flood_banganga_depth_100"
                                                            data-center="[27.60612718267851,86.12543106079102]"
                                                            name="year7" value="customEx">
                                                        <label class="custom-control-label" for="year12">100
                                                            Year</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="card">
                                    <div class="card-header" id="landslide_4">
                                        <h5>
                                            <a class="collapsed updown" role="button" data-toggle="collapse" href="#landslide_col_4" aria-expanded="false"
                                            aria-controls="landslide_col_4">Koshi
                                                <div class="icon-list">
                                                    <span class="ion ion-md-information-circle"></span>
                                                    <span class="ion ion-md-albums"></span>
                                                    <span class="ion ion-md-contrast"></span>
                                                    <span class="ion ion-md-more">
                                                        <div class="more-list">
                                                            <span class="ion ion-md-cloud-download"></span>
                                                            <span class="ion ion-md-eye"></span>
                                                            <span class="ion ion-md-remove-circle-outline"></span>
                                                        </div>
                                                    </span>
                                                </div>
                                            </a>
                                        </h5>

                                    </div>
                                    <div id="landslide_col_4" class="collapse" data-parent="#accordion" aria-labelledby="landslide_4">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="hazard-1" name="hazard-1" value="customEx">
                                                        <label class="custom-control-label" for="hazard-1">6 months </label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="hazard-2" name="hazard-2" value="customEx">
                                                        <label class="custom-control-label" for="hazard-2">1 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="hazard-3" name="hazard-3" value="customEx">
                                                        <label class="custom-control-label" for="hazard-3">5 Year</label>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="hazard-4" name="hazard-4" value="customEx">
                                                        <label class="custom-control-label" for="hazard-4">10 Year</label>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                    <!-- not needed part -->
                </div>
            </div>
            <!-- hazard popup end   -->

            <!--  exposure  popup -->

            <!-- drone part popup -->
            <div class="hazard-details trans_constrast" data-ex="OSM" id="exposure_popup">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Drone Images</h3>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>

                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">
                                <div class="card">



                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">


                                            <ul class="hazardDetail-list exposure_drone_pop">



                                                <li class="active opacityParent">

                                                    <div class="custom-control custom-radio">
                                                        <i class="ion ion-md-information-circle" style="float:right;"
                                                            data-toggle="popover" data-trigger="hover"
                                                            data-placement="left" data-content="Drone Images"></i>


                                                        <span class="ion ion-md-contrast"
                                                            style="float:right; border:none;"></span>

                                                        <input type="radio" class="custom-control-input exposure_geo"
                                                            data-workspace="Naxa" data-parent="OSM"
                                                            data-layername="bancharedanda"
                                                            data-url="https://apps.naxa.com.np/geoserver/wms"
                                                            data-center="[27.776141,85.229350]" id="test_1"
                                                            name="test_1" value="customEx">
                                                        <label class="custom-control-label" for="test_1">Drone </label>

                                                    </div>
                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="bancharedanda">
                                                    </div>
                                                </li>

                                                <li class="active opacityParent">


                                                    <div class="custom-control custom-radio">
                                                        <i class="ion ion-md-information-circle" style="float:right;"
                                                            data-toggle="popover" data-trigger="hover"
                                                            data-placement="left" data-content="Drone Images"></i>

                                                        <span class="ion ion-md-contrast"
                                                            style="float:right; border:none;"></span>

                                                        <input type="radio" class="custom-control-input exposure_geo"
                                                            data-workspace="Naxa" data-parent="OSM"
                                                            data-layername="sankhu_drone"
                                                            data-url="https://apps.naxa.com.np/geoserver/wms"
                                                            data-center="[27.740139803000158,85.46312123537065]"
                                                            id="sankhu_1" name="test_1" value="customEx">

                                                        <label class="custom-control-label" for="sankhu_1">Sankhu
                                                        </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="sankhu_drone">
                                                    </div>
                                                </li>




                                            </ul>

                                        </div>
                                    </div>


                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- drone part popup end  -->

            <!-- Infrastructes part popup -->

            <div class="hazard-details" data-ex="Land" id="infa_exposure_popup">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Infrastructures</h3>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">
                                <div class="card">


                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list exposure_drone_pop" id="exposure_infra_pop">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                            class="custom-control-input exposure_geo infan"
                                                            data-parent="Land" data-layername="buildings"
                                                            data-workspace="geonode"
                                                            data-url="https://geonepal.info/geoserver/wms"
                                                            data-center="" id="build_1" name="build_1" value="customEx">
                                                        <label class="custom-control-label" for="build_1">Buildings
                                                        </label>
                                                    </div>
                                                </li>
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                            class="custom-control-input exposure_geo infan"
                                                            data-layername="hydropower" data-parent="Land"
                                                            data-workspace="ngp:drone_test" data-url=""
                                                            data-center="[27.740139803000158,85.46312123537065]"
                                                            id="hydro_1" name="hydro_1" value="customEx">
                                                        <label class="custom-control-label" for="hydro_1">Hydropower
                                                        </label>
                                                    </div>
                                                </li>

                                                <!-- <li class="active">
                                             <div class="custom-control custom-checkbox">
                                                 <input type="checkbox" class="custom-control-input exposure_geo" data-workspace="ngp:drone_test" data-center="[27.740139803000158,85.46312123537065]" id="communication" name="communication" value="customEx">
                                                 <label class="custom-control-label" for="communication">Communication Towers  </label>
                                             </div>
                                         </li> -->


                                            </ul>
                                        </div>
                                    </div>


                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Infrastructes part popup end -->

            <div class="hazard-details" id="osmLayer_popup" data-ex="osmLayer">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>OSM Layers</h3>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">
                                <div class="card">


                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input osm_layer"
                                                            data-parent="openstreet" data-layername="osm"
                                                            data-center="[27.740139803000158,85.46312123537065]"
                                                            id="openstreet" name="openstreet" value="customEx">
                                                        <label class="custom-control-label" for="openstreet">Openstreet
                                                            Map</label>
                                                    </div>
                                                </li>
                                                <!-- <li class="active">
                                             <div class="custom-control custom-checkbox">
                                                 <input type="checkbox" class="custom-control-input exposure_geo infan" data-layername="hydropower" data-parent="Land" data-workspace="ngp:drone_test" data-url="" data-center="[27.740139803000158,85.46312123537065]" id="hydro_1" name="hydro_1" value="customEx">
                                                 <label class="custom-control-label" for="hydro_1">Terrain  </label>
                                             </div>
                                         </li>

                                         <li class="active">
                                             <div class="custom-control custom-checkbox">
                                                 <input type="checkbox" class="custom-control-input exposure_geo infan" data-layername="hydropower" data-parent="Land" data-workspace="ngp:drone_test" data-url="" data-center="[27.740139803000158,85.46312123537065]" id="hydro_1" name="hydro_1" value="customEx">
                                                 <label class="custom-control-label" for="hydro_1">Hybrid </label>
                                             </div>
                                         </li>

                                         <li class="active">
                                             <div class="custom-control custom-checkbox">
                                                 <input type="checkbox" class="custom-control-input exposure_geo infan" data-layername="hydropower" data-parent="Land" data-workspace="ngp:drone_test" data-url="" data-center="[27.740139803000158,85.46312123537065]" id="hydro_1" name="hydro_1" value="customEx">
                                                 <label class="custom-control-label" for="hydro_1">Satellite  </label>
                                             </div>
                                         </li> -->

                                                <!-- <li class="active">
                                             <div class="custom-control custom-checkbox">
                                                 <input type="checkbox" class="custom-control-input exposure_geo" data-workspace="ngp:drone_test" data-center="[27.740139803000158,85.46312123537065]" id="communication" name="communication" value="customEx">
                                                 <label class="custom-control-label" for="communication">Communication Towers  </label>
                                             </div>
                                         </li> -->


                                            </ul>
                                        </div>
                                    </div>


                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- osm layerpopup start  -->


            <!-- osm layer end -->

            <!-- popup exposure end -->

            <!-- capacity popup -->
            <div class="hazard-details" id="capacity-popup">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3 id="capacity_title"><span id="subcategory_title"
                                class="humanitarian-icon-Health-facility"></span></h3>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="capacity-content">
                        <h4>Insight</h4>
                        <div class="insight" id="subcatChartContainer">

                        </div>

                        <div class="insight" id="subcatSwitchContainer"></div>
                    </div>
                </div>

            </div>
            <!-- end capacity popup -->


            <!-- vulnerability popup -->

            <!-- communication popup -->

            <div class="hazard-details" id="vulnery-1" data-ex="GDP">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Health-facility"></span>Access To Communication</h3>
                        <i class="ion ion-md-information-circle" style="float:right;" data-toggle="popover"
                            data-trigger="hover" data-placement="left" data-content=""></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <button type="button" class="compare-button">compare</button>
                        <div class="hazard-acc">
                            <ul class="hazardDetail-list">
                                <li class="active">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="radio_com" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="radio_com">Radio </label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="television_com"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="television_com">Televison</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="mobile_com" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="mobile_com">Mobile</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="internet_com"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="internet_com">Internet</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="cablet_com" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="cablet_com">Cable Net</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="computer_com"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="computer_com">Computer</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">

                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="GDP" data-admin="municipality" id="telephone_com"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="telephone_com">Telephone</label>
                                    </div>
                                </li>
                                <!-- compare popup -->
                                <div class="compare-popup" id="compare_vul">


                                    <div class="compare-wrapper" id="radio-compare">
                                        <div class="compare-header">
                                            <h3>Access to radio</h3>
                                            <span><i class="ion ion-md-close-circle-outline"></i></span>
                                        </div>
                                        <div class="compare-body">


                                            <div id="chart">
                                                <span class="compare-info">click on the map to compare</span>
                                                <!-- <div id="tooltip" style="opacity:0">
                                                  <p><strong>Label Heading</p>
                                                    <p><span id="percentage">100</span></p>
                                                    <p><span id="value">100</span></p>

                                                  </div> -->


                                            </div>
                                        </div>
                                    </div>





                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- communication popup end -->


            <!-- access to water -->

            <div class="hazard-details" id="awt_vul" data-ex="ATW">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Health-facility"></span>Access To Water</h3>
                        <i class="ion ion-md-information-circle" style="float:right;" data-toggle="popover"
                            data-trigger="hover" data-placement="left" data-content=""></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <button type="button" class="compare-button">compare</button>
                        <div class="hazard-acc">
                            <ul class="hazardDetail-list">
                                <li class="active">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="tap_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="tap_water">Tap</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="tube_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="tube_water">tube</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="cok_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="cok_water">cok</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="unco_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="unco_water">unco</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="spou_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="spou_water">spout</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="river_water"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="river_water">river</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">

                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="other_water"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="other_water">other</label>
                                    </div>
                                </li>

                                <li>
                                    <div class="custom-control custom-radio">

                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="ATW" data-admin="municipality" id="nots_water" name="comapre_1"
                                            value="customEx">
                                        <label class="custom-control-label" for="nots_water">Not Specified</label>
                                    </div>
                                </li>

                                <!-- compare popup -->
                                <div class="compare-popup" id="compare_vul">


                                    <div class="compare-wrapper" id="radio-compare">
                                        <div class="compare-header">
                                            <h3>Access to radio</h3>
                                            <span><i class="ion ion-md-close-circle-outline"></i></span>
                                        </div>
                                        <div class="compare-body">


                                            <div id="chart">
                                                <span class="compare-info">click on the map to compare</span>
                                                <!-- <div id="tooltip" style="opacity:0">
                                       <p><strong>Label Heading</p>
                                         <p><span id="percentage">100</span></p>
                                         <p><span id="value">100</span></p>

                                       </div> -->


                                            </div>
                                        </div>
                                    </div>





                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- access to water end-->


            <!-- access to water -->

            <div class="hazard-details" id="toil_vul" data-ex="TOIL">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Health-facility"></span>Access To Toilet</h3>
                        <i class="ion ion-md-information-circle" style="float:right;" data-toggle="popover"
                            data-trigger="hover" data-placement="left" data-content=""></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <button type="button" class="compare-button">compare</button>
                        <div class="hazard-acc">
                            <ul class="hazardDetail-list">
                                <li class="active">
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="TOIL" data-admin="municipality" id="wit_toilet"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="wit_toilet">without</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="TOIL" data-admin="municipality" id="flush_toilet"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="flush_toilet">flush</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="TOIL" data-admin="municipality" id="ordinary_toilet"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="ordinary_toilet">ordinary</label>
                                    </div>
                                </li>
                                <li>
                                    <div class="custom-control custom-radio">
                                        <input type="radio" class="custom-control-input socio nt_loaded admin_bound"
                                            data-parent="TOIL" data-admin="municipality" id="not_toilet"
                                            name="comapre_1" value="customEx">
                                        <label class="custom-control-label" for="not_toilet">not Specified</label>
                                    </div>
                                </li>


                                <!-- compare popup -->
                                <div class="compare-popup" id="compare_vul">


                                    <div class="compare-wrapper" id="radio-compare">
                                        <div class="compare-header">
                                            <h3>Access to radio</h3>
                                            <span><i class="ion ion-md-close-circle-outline"></i></span>
                                        </div>
                                        <div class="compare-body">


                                            <div id="chart">
                                                <span class="compare-info">click on the map to compare</span>
                                                <!-- <div id="tooltip" style="opacity:0">
                                       <p><strong>Label Heading</p>
                                         <p><span id="percentage">100</span></p>
                                         <p><span id="value">100</span></p>

                                       </div> -->


                                            </div>
                                        </div>
                                    </div>





                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- access to water end-->

            <!-- hdi start-->


            <div class="hazard-details trans_constrast" id="hdi_vul" data-ex="HDI">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>HDI</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left"
                            data-content="The Human Development Index is a statistic composite index of life expectancy, education, and per capita income indicators"></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                         <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                             <div class="card-body">
                                 <ul class="hazardDetail-list">
                                     <li class="active">
                                         <div class="custom-control custom-checkbox">
                                             <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                             <label class="custom-control-label" for="hdi_national">National Level </label>
                                         </div>
                                     </li>
                                   </ul>
                             </div>
                         </div>
                     </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active ">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-parent="HDI" data-legendname="HDI" data-score="hdi"
                                                            data-admin="district" id="hdi_district" name="hdi_district"
                                                            value="customEx">
                                                        <label class="custom-control-label" for="hdi_district">District
                                                            Level </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                         <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                             <div class="card-body">
                                 <ul class="hazardDetail-list">
                                     <li class="active">
                                         <div class="custom-control custom-checkbox">
                                             <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                             <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                         </div>
                                     </li>
                                   </ul>
                             </div>
                         </div>
                     </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>




            <!-- hdi end -->

            <!-- remoteness -->

            <div class="hazard-details trans_constrast" id="remote_vul" data-ex="REMOTE">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Remoteness</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left"
                            data-content="It is an indicator of acccessibility; data available district wise"></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                        <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                            <div class="card-body">
                                <ul class="hazardDetail-list">
                                    <li class="active">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                            <label class="custom-control-label" for="hdi_national">National Level </label>
                                        </div>
                                    </li>
                                  </ul>
                            </div>
                        </div>
                    </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-legendname="Remoteness" data-parent="REMOTE"
                                                            data-score="remoteness" data-admin="district"
                                                            id="remote_district" name="remote_district"
                                                            value="customEx">
                                                        <label class="custom-control-label"
                                                            for="remote_district">District Level </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>

                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                        <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                            <div class="card-body">
                                <ul class="hazardDetail-list">
                                    <li class="active">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                            <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                        </div>
                                    </li>
                                  </ul>
                            </div>
                        </div>
                    </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- remoteness end-->

            <!-- risk start popup -->

            <div class="hazard-details trans_constrast" id="earthquake_risk" data-ex="earthquake_r">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Earthquake Risk</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left"
                            data-content="Tom R Robinson, Nicholas J Rosser, Alexander L Densmore, Katie J Oven, Surya N Shrestha, Ramesh Guragain, 2019. The risk analaysis is based on 90 scenario ensembles and vulnerability indexes ( Remoteness index, Human Development Index"></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                        <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                            <div class="card-body">
                                <ul class="hazardDetail-list">
                                    <li class="active">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                            <label class="custom-control-label" for="hdi_national">National Level </label>
                                        </div>
                                    </li>
                                  </ul>
                            </div>
                        </div>
                    </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-legendname="Earthquake Risk" data-parent="earthquake_r"
                                                            data-score="riskScore" data-admin="district"
                                                            id="earthquake_district" name="earthquake_district"
                                                            value="customEx">
                                                        <label class="custom-control-label"
                                                            for="earthquake_district">District Level </label>
                                                    </div>
                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                        <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                            <div class="card-body">
                                <ul class="hazardDetail-list">
                                    <li class="active">
                                        <div class="custom-control custom-checkbox">
                                            <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                            <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                        </div>
                                    </li>
                                  </ul>
                            </div>
                        </div>
                    </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- risk end popup -->

            <!-- Per Capita Income -->

            <div class="hazard-details trans_constrast" id="pci_vul" data-ex="PCI">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Per Capita Income</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left" data-content=""></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                                  <label class="custom-control-label" for="hdi_national">National Level </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-legendname="Per Capita Income" data-parent="PCI"
                                                            data-score="perCapitaIncome" data-admin="district"
                                                            id="pci_district" name="pci_district" value="customEx">
                                                        <label class="custom-control-label" for="pci_district">District
                                                            Level </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>

                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                                  <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- per capita income end-->


            <!-- life Expectancy -->

            <div class="hazard-details trans_constrast" id="le_vul" data-ex="LE">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Life Expectancy</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left" data-content=""></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                                  <label class="custom-control-label" for="hdi_national">National Level </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-legendname="Life Expectancy" data-parent="LE"
                                                            data-score="lifeExpectancy" data-admin="district"
                                                            id="le_district" name="le_district" value="customEx">
                                                        <label class="custom-control-label" for="le_district">District
                                                            Level </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>

                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                                  <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--life Expectancy end-->


            <!-- Human poverty Index -->

            <div class="hazard-details trans_constrast" id="hpi_vul" data-ex="HPI">
                <div class="hazard-wrapper">
                    <div class="hazard-title">
                        <h3><span class="humanitarian-icon-Flood"></span>Human POverty Index</h3>
                        <i class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover"
                            data-placement="left"
                            data-content="The Human Poverty Index (HPI) is an indication of the standard of living in a country"></i>
                        <button type="button" class="button average-open"><i class="  ion ion-ios-expand"></i></button>
                        <button type="button" class="button hazardDetails-close"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="hazard-content">
                        <!-- <h4>Hazard</h4> -->
                        <div class="hazard-acc">
                            <div id="accordion">

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound vul_hdi" data-score="hdi"  id="hdi_national" name="hdi_national"  value="customEx">
                                                  <label class="custom-control-label" for="hdi_national">National Level </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->

                                <div class="card opacityParent">
                                    <div id="landslide_col_1" class="collapse show" data-parent="#accordion"
                                        aria-labelledby="landslide_1">
                                        <div class="card-body">
                                            <span class="ion ion-md-contrast" style="float:right;"></span>
                                            <ul class="hazardDetail-list">
                                                <li class="active">
                                                    <div class="custom-control custom-radio">
                                                        <input type="radio"
                                                            class="custom-control-input admin_bound vul_hdi nt_loaded"
                                                            data-legendname="Human Poverty Index" data-parent="HPI"
                                                            data-score="humanPovertyIndex" data-admin="district"
                                                            id="hpi_district" name="hpi_district" value="customEx">
                                                        <label class="custom-control-label" for="hpi_district">District
                                                            Level </label>
                                                    </div>

                                                    <div class="range-box">
                                                        <input type="range" min="0" max="100" class="center"
                                                            data-name-trans="district">
                                                    </div>

                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- <div class="card">
                              <div id="landslide_col_1" class="collapse show" data-parent="#accordion" aria-labelledby="landslide_1">
                                  <div class="card-body">
                                      <ul class="hazardDetail-list">
                                          <li class="active">
                                              <div class="custom-control custom-checkbox">
                                                  <input type="checkbox" class="custom-control-input admin_bound" data-admin="municipality"  id="hdi_munci" name="hdi_munci" value="customEx">
                                                  <label class="custom-control-label" for="hdi_munci">Municipality Level  </label>
                                              </div>
                                          </li>
                                        </ul>
                                  </div>
                              </div>
                          </div> -->




                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Human poverty Index end-->



            <!-- vulnerability popup end -->

            <!-- rightSidebar end -->



            <!-- average section -->
            <div class="average-section">
                <div class="average-wrapper">
                    <div class="average-header">
                        <h4>Data visualization</h4>
                        <button type="button" class="button averageClose"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="average-content">
                        <div class="progress-list">
                            <!-- <div class="progress-warpper">
                                <div class="progress skill-bar ">
                                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">kathmandu :<i class="val">2456</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" >
                                    </div>
                                </div>
                                <span class="skill">Kaski :<i class="val">3565</i></span>
                            </div>

                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Lalitpur :<i class="val">1400</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Manang :<i class="val">800</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Bhaktapur :<i class="val">1100</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Nepalgunj :<i class="val">400</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Dhangadi :<i class="val">600</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Dharan :<i class="val">650</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Dhankuta :<i class="val">900</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Humla :<i class="val">400</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Mahottari :<i class="val">600</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Lamjung :<i class="val">650</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Tanahu :<i class="val">900</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Morang :<i class="val">400</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Sunsari :<i class="val">600</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Makwanpur :<i class="val">650</i></span>
                            </div>
                            <div class="progress-warpper">
                                <div class="progress skill-bar">
                                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100">
                                    </div>
                                </div>
                                <span class="skill">Taplejung :<i class="val">900</i></span>
                            </div> -->
                            <!-- <div class="barchart-line" style="left:100%">
                                <span class="average-text">Average</span>
                            </div> -->

                        </div>
                    </div>
                </div>

            </div>

            <div class="metaData">
                <div class="metaData-wrapper">
                    <div class="metaData-header">
                        <h4>meta data</h4>
                        <button type="button" class="button metaClose"><i
                                class=" ion ion-md-close-circle-outline"></i></button>
                    </div>
                    <div class="metaData-content">
                        <h4>Metadata Record Info</h4>
                        <ul>
                            <li>
                                <label>Language :</label> English
                            </li>
                            <li>
                                <label>Chareset :</label> Utf8
                            </li>
                            <li>
                                <label>Hierarchy Level :</label> dataset
                            </li>
                            <li>
                                <label>Standard date :</label> North American Profile of ISO 19115:2003
                            </li>
                        </ul>
                    </div>
                    <div class="metaData-content">
                        <h4>Contact</h4>
                        <ul>
                            <li>
                                <label>Name :</label> National Geographic Information Infrastructure Division
                            </li>
                            <li>
                                <label>Organization Name :</label> National Geographic Information Infrastructure
                                Division
                            </li>
                            <li>
                                <label>Position Name :</label> Chief Survey Officer
                            </li>
                            <li>
                                <label>Role :</label> author
                            </li>
                        </ul>
                    </div>
                </div>
            </div>


        </div>
        <!-- mapsection end -->
    </div>
    <!-- bipad end -->



    <!-- js library start -->
    <!-- <script src="{% static 'mappage/js/jquery-3.3.1.min.js' %}"></script> -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="{% static 'mappage/js/popper.min.js' %}"></script>


    <!-- <script src="{% static 'mappage/js/bootstrap.min.js' %}"></script> -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
        integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
        crossorigin=""></script>
    <script src="{% static 'mappage/js/select2.min.js' %}"></script>
    <script src="{% static 'mappage/js/jquery.slimscroll.min.js' %}"></script>
    <!-- <script src="{% static 'mappage/js/map.js' %}"></script> -->

    <script src="{% static 'mappage/js/L.TileLayer.BetterWMS.js' %}"></script>
    <script src="{% static 'mappage/js/chart.js' %}"></script>
    <script src="{% static 'mappage/js/d3.min.js' %}"></script>
    <script src="{% static 'mappage/js/d3.v3.min.js' %}"></script>
    <script src="{% static 'mappage/js/c3.js' %}"></script>
    <script src="{% static 'mappage/js/leaflet.draw.js' %}"></script>
    <script src="{% static 'mappage/js/proj4.js' %}"></script>
    <script src="{% static 'mappage/js/leaflet-wfst.src.js' %}"></script>
    <script src="{% static 'mappage/js/nouislider.min.js' %}"></script>
    <script src="https://unpkg.com/leaflet.vectorgrid@1.2.0/dist/Leaflet.VectorGrid.bundled.js"></script>


    <!-- chart-pie -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <!-- FusionCharts -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.11.0/d3.min.js"></script>
    <!-- chart -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>

    <script src="{% static 'mappage/js/script.js' %}"></script>





    <!-- <script src="js/popper.min.js"></script> -->





    <!-- <script src="js/chart.js"></script>
	<script src="js/c3.js"></script> -->
    {% comment %}
    <script src="js/map.js"></script> {% endcomment %}
    <script>
        if (document.location.hostname == 'localhost') {
            var base_url = 'http://localhost:8000';
        } else if (document.location.hostname == 'bipad.naxa.com.np') {
            var base_url = 'https://bipad.naxa.com.np';
        } else {
            var base_url = 'https://bipad.nepware.com';
        }




        $(document).ready(function () {

            $('.loader').css('display', 'block')
            // initializing map

            map = L.map('mapid', {
                zoomControl: false

            }).setView([28.410728397237914, 84.4024658203125], 7);
            // map.attributionControl.addAttribution("<a href='http://www.naxa.com.np' title = 'Contributor'>NAXA</a>");
            // map.scrollWheelZoom.disable();
            //map.options.maxBounds;  // remove the maxBounds object from the map options
            //map.options.minZoom = 9;
            map.createPane("tilePane").style.zIndex = 200;
            map.createPane("baseLayerPane").style.zIndex = 250;
            map.createPane("wmsPane").style.zIndex = 300;
            map.createPane("overlayPane").style.zIndex = 400;
            map.createPane("polygonsPane").style.zIndex = 450;
            map.createPane("linesPane").style.zIndex = 460;
            map.createPane("shadowPane").style.zIndex = 500;
            map.createPane("markerPane").style.zIndex = 600;
            map.createPane("pointsPane").style.zIndex = 600;
            map.createPane("tooltipPane").style.zIndex = 650;
            map.createPane("popupPane").style.zIndex = 700;
            map.createPane("maskPane").style.zIndex = 700;
            map.createPane("topPane").style.zIndex = 701;


            //map.options.minZoom = 14;
            ////////
            var accessToken = "pk.eyJ1IjoidXBlbmRyYW9saSIsImEiOiJjaWYwcnFnNmYwMGY4dGZseWNwOTVtdW1tIn0.uhY72SyqmMJNTKa0bY-Oyw";
            //  var mapboxTiles = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/bipad/tiles/{z}/{x}/{y}?access_token='+accessToken, {
            //        attribution: '© <a href="https://www.mapbox.com/feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            // }).addTo(map);
            L.control.scale({
                position: 'bottomright',
                metric: true,
                imperial: false
            }).addTo(map);
            L.control.zoom({
                position: 'bottomright'
            }).addTo(map);


            var mapboxTiles = L.tileLayer('https://api.mapbox.com/styles/v1/upendraoli/cjuvfcfns1q8r1focd0rdlgqn/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoidXBlbmRyYW9saSIsImEiOiJjaWYwcnFnNmYwMGY4dGZseWNwOTVtdW1tIn0.uhY72SyqmMJNTKa0bY-Oyw', {
                attribution: '&copy; <a href="https://www.mapbox.com">Mapbox</a>'
            }).addTo(map);
            // .addTo(map);
            //  var osm = L.tileLayer('https://a.tiles.mapbox.com/v3/mapbox.world-bright/{z}/{x}/{y}.png', {
            //    attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',
            //    // pane:"baseLayerPane"
            //  });
            var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });

            googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
                pane: "baseLayerPane"
            });
            googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
                pane: "baseLayerPane"
            });
            googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
                pane: "baseLayerPane"
            });
            googleTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
                pane: "baseLayerPane"
            });

            //end initializing map

            //admin boundary layers map Layer

            // fed_url_prov="https://bipad.nepware.com/api/v1/municipality/?format=geojson";
            // fed_url_district="https://bipad.nepware.com/api/v1/district/?format=geojson";



            //getBounds of geoserver layers
            function GetCapabilitiesGeoserver(layerName, geoserver_url, geoserver_workspace) {
                var geoserver_layer_bbox = [];
                $.ajax({
                    type: "GET",
                    async: false,
                    name: layerName,
                    url: geoserver_url + "/" + geoserver_workspace + "/wms?request=GetCapabilities&service=WMS&version=1.0.0",
                    beforeSend: function () { },
                    complete: function () { },
                    success: function (result) {
                        ////
                        var layerN = this.name;
                        data = $.parseXML(result);
                        var geoserver_all_layers = data.getElementsByTagName('Layer');
                        ////
                        for (var i = 0; i < geoserver_all_layers.length; i++) {

                            var geoserver_layername = geoserver_all_layers[i].getElementsByTagName('Name')[0].innerHTML;

                            if (i == 8 || i == 6) {
                                //
                                //
                            }
                            if (layerN == geoserver_layername) {
                                //
                                var bboxText = geoserver_all_layers[i].getElementsByTagName('LatLonBoundingBox')[0].outerHTML;
                                //
                                var bboxTextArray = bboxText.split('=');

                                var a = bboxTextArray[1].split(",")[0].split(" ");
                                var minx = parseFloat(a[0].slice(1, -1));

                                var b = bboxTextArray[2].split(",")[0].split(" ");
                                var miny = parseFloat(b[0].slice(1, -1));

                                var c = bboxTextArray[3].split(",")[0].split(" ");
                                var maxx = parseFloat(c[0].slice(1, -1));

                                var d = bboxTextArray[4].split(",");
                                var maxy = parseFloat(d[0].slice(1, -1));

                                geoserver_layer_bbox = [
                                    [miny, minx],
                                    [maxy, maxx]
                                ];
                            }
                        }

                    }
                });

                return geoserver_layer_bbox;
            }
            //var link = "https://apps.naxa.com.np/geoserver";
            //var workspace = "Naxa";
            //var layer_bbox = GetCapabilitiesGeoserver('Health', link, workspace);
            ////

            //end get bounds of geoserver layers



            //removing all layers
            function removeAllLayers() {
                $('.custom-control .custom-radio').removeClass().addClass('custom-control custom-radio');
                if (map.hasLayer(district)) {
                    map.removeLayer(district)
                }
                if (map.hasLayer(municipality)) {
                    map.removeLayer(municipality)
                }
                map.eachLayer(function (layer) {
                    //  ////
                    if (layer == province || layer == district || layer == municipality || layer == mapboxTiles) {


                    } else {

                        map.removeLayer(layer);

                    }
                });

                if (map.hasLayer(federal_boundary)) {
                    map.addLayer(label);
                }
                // map.addLayer(province);
                $('.legend-list').html('');
            }

            //////
            function highlight(layer) {
                layer.setStyle({
                    fillColor: "green",
                    fillOpacity: 0.5,
                    weight: 1,
                    opacity: 0.2,
                    color: 'black',
                    dashArray: ''
                });
            }

            function resetHighlight(layer) {
                layer.setStyle({
                    weight: 1,
                    dashArray: ''
                });
            }




            labelcount = 0;

            function countEqual(oo, pp) {

                //var i, equal = true;
                var singleloopend = 0;
                ////
                $.each(oo, function (i) {

                    // //
                    // //
                    if (singleloopend == 0) {
                        labelcount = 0;
                    }
                    if (oo[i]._latlng.lat == pp._latlng.lat && oo[i]._latlng.lng == pp._latlng.lng) {
                        labelcount++;
                    }

                    singleloopend++;
                });
                ////
                return labelcount;
            }



            vt_label_province = L.layerGroup();
            vt_label_district = L.layerGroup();
            vt_label_municipality = L.layerGroup();
            var label = null;

            function label_Vector_Tiles(feature) {
                var name = "";
                var lat = feature.properties.Centroid_Y;
                var long = feature.properties.Centroid_X;
                if (feature.properties.hasOwnProperty('PROV_NAME')) {
                    name = feature.properties.PROV_NAME;
                    var divIconP = L.divIcon({
                        html: "<span class='fed_labelText' style='color:blue;'>" + name + "</span>",
                        iconAnchor: [12, 0],
                    });

                    vt_label_marker_P = L.marker([lat, long], {
                        icon: divIconP
                    });
                    ////
                    if (countEqual(vt_label_province._layers, vt_label_marker_P) > 0) {
                        //do nothing
                    } else {
                        // //
                        vt_label_marker_P.addTo(vt_label_province);
                    }



                    // $.each(vt_label_province._layers, function (key) {
                    //    // 0
                    // });
                } else if (feature.properties.hasOwnProperty('DistLabel')) {
                    name = feature.properties.Name;
                    var divIconD = L.divIcon({
                        html: "<span class='fed_labelText' style='color:white !important; background:none;'>" + name + "</span>",
                        iconAnchor: [12, 0],
                    });

                    vt_label_marker_D = L.marker([lat, long], {
                        icon: divIconD
                    });
                    ////
                    if (countEqual(vt_label_district._layers, vt_label_marker_D) > 0) {
                        //do nothing
                    } else {
                        // //
                        vt_label_marker_D.addTo(vt_label_district);
                    }
                } else if (feature.properties.hasOwnProperty('GaPa_NaPa')) {
                    name = feature.properties.Name;
                    var divIconM = L.divIcon({
                        html: "<span class='fed_labelText' style='color:white !important;background:none;'>" + name + "</span>",
                        iconAnchor: [12, 0],
                    });

                    vt_label_marker_M = L.marker([lat, long], {
                        icon: divIconM
                    });
                    //vt_label_marker_M.addTo(vt_label_muclnicipality);
                    if (countEqual(vt_label_municipality._layers, vt_label_marker_M) > 0) {
                        //do nothing
                    } else {
                        // //
                        vt_label_marker_M.addTo(vt_label_municipality);
                    }
                }
                //image icon width and margin left
                $('.fed_labelText').parent().css('width', '100px');
                //image icon width and margin left


            }

            map.addLayer(vt_label_province);


            map.on('zoomend', function (e) {
                var zoom = map.getZoom();
                var activeLayer = null;
                if (map.hasLayer(district)) {
                    activeLayer = vt_label_district;
                } else if (map.hasLayer(municipality)) {
                    activeLayer = vt_label_municipality;
                } else {
                    activeLayer = vt_label_province;
                }
                ////
                if (zoom < 7 && activeLayer == vt_label_province) {
                    map.removeLayer(vt_label_province);
                } else if (zoom < 9 && activeLayer == vt_label_district) {
                    map.removeLayer(vt_label_district);
                    map.removeLayer(vt_label_province);
                } else if (zoom < 11 && activeLayer == vt_label_municipality) {
                    map.removeLayer(vt_label_municipality);
                    map.removeLayer(vt_label_district);
                    map.removeLayer(vt_label_province);
                } else if (zoom > 7 && map.hasLayer(province)) {
                    labelcount = 0;
                    map.addLayer(vt_label_province);
                    map.addLayer(activeLayer);
                }
            });


            // Set vectorTileOptions
            vectorTileOptions = {
                tms: true,
                vectorTileLayerStyles: {
                    'District': function () {
                        return {
                            fillColor: "blue",
                            fillOpacity: 0,
                            weight: 1,
                            opacity: 1,
                            color: '#a3b7e3',
                            fill: true,
                        }
                    },
                    'Province': function () {
                        return {
                            fillColor: "blue",
                            fillOpacity: 0,
                            weight: 1.7,
                            opacity: 1,
                            color: '#a3b7e3',
                            fill: true,
                        }
                    },
                    'Municipality': function () {
                        return {
                            fillColor: "blue",
                            fillOpacity: 0,
                            weight: 1,
                            opacity: 1,
                            color: '#a3b7e3',
                            fill: true,
                        }
                    },
                },
                interactive: true, // Make sure that this VectorGrid fires mouse/pointer events
                pane: "wmsPane",
                getFeatureId: function (feature) {
                    //////
                    label_Vector_Tiles(feature);
                    return feature.properties.id;
                }
            }

            var name;
            var clearHighlight = function (name) {
                //////
                if (name) {
                    district.resetFeatureStyle(name);
                }
                name = null;
            };

            // Creating the full vectorTile url
            var provinceUrl = 'https://geoserver.naxa.com.np/geoserver/gwc/service/tms/1.0.0/Bipad:Province@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf';
            var districtUrl = 'https://geoserver.naxa.com.np/geoserver/gwc/service/tms/1.0.0/Bipad:District@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf';
            var municipalityUrl = 'https://geoserver.naxa.com.np/geoserver/gwc/service/tms/1.0.0/Bipad:Municipality@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf';


            // Creating the Leaflet vectorGrid object
            province = L.vectorGrid.protobuf(provinceUrl, vectorTileOptions).addTo(map);
            var province_bbox = GetCapabilitiesGeoserver('Province', 'https://geoserver.naxa.com.np/geoserver', 'Bipad');
            //
            map.fitBounds(province_bbox);

            district = L.vectorGrid.protobuf(districtUrl, vectorTileOptions);
            municipality = L.vectorGrid.protobuf(municipalityUrl, vectorTileOptions);

            district.on('click', function (e) {
                //
                //
            });
            district.on('mouseover', function (e) {
                // //
                // //
                L.popup({
                    //closeOnClick: true,
                    //closeButton: true,
                    keepInView: true,
                    autoPan: true,
                    maxHeight: 200,
                    minWidth: 250,
                    pane: "topPane"
                })
                var popup = L.popup({
                    pane: "topPane"
                }).setLatLng(e.latlng)
                    .setContent('<ul class="list-group list-group-unbordered"><li class="list-group-item popup-list"><b></b> <a class="pull-right">' + e.layer.properties.DistLabel + '</a></li><li class="list-group-item popup-list"><b>Value:' + e.layer.options.value + '</a></li></ul>')
                    .openOn(map);

            });
            district.on('mouseout', function (e) {
                // //
                map.closePopup();
            });
            municipality.on('mouseover', function (e) {
                // //
                // //
                var popup = L.popup({
                    pane: "topPane"
                }).setLatLng(e.latlng)
                    .setContent('<ul class="list-group list-group-unbordered"><li class="list-group-item popup-list"><b></b> <a class="pull-right">' + e.layer.properties.Name + '</a></li><li class="list-group-item popup-list"><b>Value:' + e.layer.options.value + '</a></li></ul>')
                    .openOn(map);

            });
            municipality.on('mouseout', function (e) {
                // //
                map.closePopup();
            });
            //map.fitBounds(province.getBounds());
            function AdminLayerPopup(e, addPopup, name) {
                if (addPopup) {
                    adminPopup = L.popup()
                        .setContent('Province: ' + e.layer.properties.name)
                        .setLatLng(e.latlng)
                        .openOn(map);
                } else {
                    //////
                    map.removeLayer(adminPopup);
                }



            }

            function highlightLayers(layer, featureName) {
                //////
                layer.setFeatureStyle(featureName, {
                    weight: 2,
                    color: 'red',
                    opacity: 1,
                    fillColor: 'red',
                    fill: true,
                    //radius: 6,
                    fillOpacity: 0.5
                })
            }



            // Define the action taken once a polygon is clicked. In this case we will create a popup with the camping name
            province.on('mouseover', function (e) {
                ////////
                //AdminLayerPopup(e,true,'PROV_NAME');

            }).on('mouseout', function (e) {
                //AdminLayerPopup(e,false,'PROV_NAME');
            });


            district.on('mouseover', function (e) {
                ////////
                //AdminLayerPopup(e,true, 'DISTRICT');

            }).on('mouseout', function (e) {
                //AdminLayerPopup(e,false, 'DISTRICT');
            });

            var previous_style;
            var style_array = [];
            municipality.on('click', function (e) {
                $('#chart > span').remove();
                ////////
                $('.compare-info').css('display', 'none');
                if ($(".compare-wrapper").css('display') == "block") {
                    //highlightLayers;
                    //
                    // var previous_style= e.layer.options;

                    // //
                    // //
                    if (e.layer.options.color != "red") {
                        style_array.push(Object.assign({}, e.layer.options, e.layer.properties));
                        //
                        municipality.setFeatureStyle(e.layer.properties.id, {
                            weight: 2,
                            color: 'red',
                            opacity: 1,
                            //  fillColor: 'red',
                            fill: true,
                            //radius: 6,
                            fillOpacity: 0.5
                        })
                        //
                        //end
                        var mun = e.layer.properties.GaPa_NaPa;
                        $.ajax({
                            // async:false,
                            url: base_url + '/risk_profile/socio/' + mun,
                            success: function (result) {
                                //////
                                if (result.length != 0) {
                                    //////




                                    dataset = [{
                                        label: "No Facility",
                                        count: result[0].noFacilityCom
                                    }, {
                                        label: "Atleast One",
                                        count: result[0].oneAtleastCom
                                    }, {
                                        label: "Radio",
                                        count: result[0].radioCom
                                    }, {
                                        label: "Television",
                                        count: result[0].televisionCom
                                    }, {
                                        label: "Cablet",
                                        count: result[0].cabletCom
                                    }, {
                                        label: "Computer",
                                        count: result[0].computerCom
                                    }, {
                                        label: "Internet",
                                        count: result[0].internetCom
                                    }, {
                                        label: "Telephone",
                                        count: result[0].telephoneCom
                                    }, {
                                        label: "Mobile",
                                        count: result[0].mobileCom
                                    },];
                                    //
                                    //
                                    //
                                    //
                                    // if (dataset[0].count == 0) {
                                    // $('#chart').append('<div class = "chartWrapper" id=' + id + ' ><div style="margin-bottom:10px;"><h7 class="chart_header">' + name + '</h7></div><div id="chartBody_' + name + '"><label>No Data</label></div></div>');
                                    // //
                                    // }
                                    // else {
                                    createChartCompare(dataset, mun, e.layer.properties.id);
                                    L.popup()
                                        .setContent(e.layer.properties.GaPa_NaPa)
                                        .setLatLng(e.latlng)
                                        .openOn(map);
                                    // }
                                } else {


                                }

                            }
                        });
                    } else {
                        // //
                        var required_color = style_array.find(item => item.id === e.layer.properties.id);
                        // previous_style
                        municipality.setFeatureStyle(e.layer.properties.id, {
                            weight: required_color.weight,
                            color: required_color.color,
                            opacity: required_color.opacity,
                            fillColor: required_color.fillColor,
                            fill: required_color.fill,
                            radius: required_color.radius,
                            fillOpacity: required_color.fillOpacity
                        })
                        var elementindex = style_array.findIndex(item => item.id === e.layer.properties.id);
                        //

                        //
                        style_array.splice(elementindex, 1);
                        //
                        //  var newstyle_array= style_array.filter(item=>item.id!== e.layer.properties.id);
                        //  style_array=newstyle_array;
                        //  //
                        var chart_id = document.getElementById('chart');
                        var child_id = document.getElementById(e.layer.properties.id);
                        chart_id.removeChild(child_id);
                    }

                    ////////
                } else {
                    //resetHighlight(layer);
                }

            });


            // Add the vectorGrid to the map
            //province.addTo(map);
            //district.addTo(map);
            //municipality.addTo(map);


            //admin boundary layers map Layer end

            //required functions

            function resetStyle() {
                return {
                    fillColor: "blue",
                    fillOpacity: 0,
                    weight: 1,
                    opacity: 0.2,
                    color: 'black',
                    fill: true,
                }
            }

            function getColor(d) { //getting color according to data density
                return d > 1000 ? '#800026' :
                    d > 500 ? '#BD0026' :
                        d > 200 ? '#E31A1C' :
                            d > 100 ? '#FC4E2A' :
                                d > 50 ? '#FD8D3C' :
                                    d > 20 ? '#FEB24C' :
                                        d > 10 ? '#FED976' :
                                            '#FFEDA0';
            }

            function socioStyle(number) { //creating style

                return {
                    fillColor: getColor(number),
                    weight: 2,
                    opacity: 1,
                    color: 'white',
                    dashArray: '3',
                    fillOpacity: 0.7,
                    fill: true,
                    value: number
                };

            }


            function riskgetColor(d) {
                //getting color according to data density
                return d > 1 ? '#800026' :
                    d > 0.9 ? '#BD0026' :
                        d > 0.8 ? '#E31A1C' :
                            d > 0.6 ? '#FC4E2A' :
                                d > 0.4 ? '#FD8D3C' :
                                    d > 0.2 ? '#FEB24C' :
                                        d > 0 ? '#FED976' :
                                            '#FFEDA0';
            }

            function riskStyle(number) { //creating style
                //

                return {
                    fillColor: riskgetColor(number),
                    weight: 2,
                    opacity: 1,
                    color: 'white',
                    dashArray: '3',
                    fillOpacity: 0.7,
                    fill: true,
                    value: number
                };

            }

            function earthRiskgetColor(d, maxvalue, minvalue) {
                //getting color according to data density

                var intervals = range(minvalue, maxvalue, (maxvalue - minvalue) / 5); // gives min to max values
                //
                var color_range = ["#FED976", "#FD8D3C", "#E31A1C", "#BD0026", "#800026"]; //min to max (light to dark)
                var legend;
                for (var i = intervals.length - 1; i >= 0; i--) {

                    if (d <= minvalue) {
                        return color_range[0];
                    }
                    if (d >= maxvalue) {
                        return color_range[color_range.length - 1];
                    }

                    if (d > intervals[i]) {
                        return color_range[i];
                    }


                }
                //  return d > 80 ? '#800026' :
                //         d > 60  ? '#BD0026' :
                //         d > 40  ? '#E31A1C' :
                //         d > 20  ? '#FD8D3C' :
                //                   '#FED976' ;

            }

            function earthRiskStyle(number, maxvalue, minvalue) { //creating style
                // //
                ////
                return {
                    fillColor: earthRiskgetColor(number, maxvalue, minvalue),
                    weight: 2,
                    opacity: 1,
                    color: 'white',
                    dashArray: '3',
                    fillOpacity: 0.7,
                    fill: true,
                    value: number

                };

            }

            //neew changhes

            function loadSocioData(socioid, parent_id) { //loding socia data in map layers
                ////////

                $('.progress-list').html('');
                fed_url_api = base_url + "/risk_profile/Newfile/" + socioid;

                socioid1 = socioid.split("_")[0] + socioid.split("_")[1].charAt(0).toUpperCase() + socioid.split("_")[1].slice(1);
                ////////
                $.ajax({
                    // async:false,
                    url: fed_url_api,
                    success: function (result) {

                        ////////
                        //////
                        avg_val = (Math.round(result.avg) / result.sum) * 100;






                        //var features = municipality._layers;
                        var visual_html = '';
                        if ($('#' + socioid).hasClass('nt_loaded')) {
                            //
                            // map.addLayer(vt_label_district);
                            if (map.hasLayer(label)) {
                                map.removeLayer(label);
                            }
                            for (var i = 0; i < result.data.length; i++) {

                                var val_now = result.data[i][socioid1];



                                visual_html += '<div class="progress-warpper">' +
                                    '<div class="progress skill-bar ">' +
                                    '<div class="progress-bar progress-bar-success" role="progressbar" style="width:' + (Math.round(val_now) / result.sum) * 100 + '%;" aria-valuenow="' + (Math.round(val_now) / result.sum) * 100 + '" aria-valuemin="0" aria-valuemax="100">' +
                                    '</div>' +
                                    '</div>' +
                                    '<span class="skill">' + result.data[i]["name"] + ' :<i class="val">' + val_now + '</i></span>' +
                                    '</div>';





                                municipality.setFeatureStyle(result.data[i]["municipalityId"], socioStyle(parseInt(result.data[i][socioid1])));




                            }

                            $('#' + parent_id).attr('data-currentLayer', 'municipality')
                            $('#' + parent_id).attr('data-result', JSON.stringify(result.data))
                            $('#' + parent_id).prop('checked', true);



                            visual_html += '<div class="barchart-line" style="left:' + avg_val + '%">' +
                                '<span class="average-text"> National Average</span>' +
                                '</div>';
                            ////////
                            ////////

                            $('.progress-list').append(visual_html);

                            $('#' + socioid).removeClass('nt_loaded');

                        } else {

                            // map.removeLayer(vt_label_district);
                            // if (!map.hasLayer(label) && label != undefined) {
                            //   map.addLayer(label);
                            // }
                            //
                            if (map.hasLayer(label)) {
                                //
                            } else if (label != null) {
                                //
                                //
                                map.addLayer(label);
                            }

                            for (var j = 0; j < result.data.length; j++) {
                                municipality.setFeatureStyle(result.data[j]["municipalityId"], resetStyle());
                            }
                            map.removeLayer(vt_label_municipality);
                            map.removeLayer(municipality);
                            $('.legend-list').html('');
                            $('#' + parent_id).attr('data-currentLayer', '');
                            $('#' + parent_id).attr('data-result', '');
                            $('#' + parent_id).prop('checked', false);
                            //district.setFeatureStyle(result.results[i]["districtId"], resetStyle());
                            $('#' + socioid).addClass('nt_loaded');
                        }
                        $('.loader').css('display', 'none');
                    }

                });

                //new ajax
                var legend_html = '<div class="legend-wrapper">' +
                    '<div class="buffer-header">' +
                    '<h4>' + socioid.replace("_", " ") + '</h4>' +
                    '<span><i class="ion ion-md-close"></i></span>' +
                    '</div>' +
                    '<ul>' +
                    '<li class="satelite"><span style="background-color:#FFEDA0;"></span><a href="#">0-10</a></li>' +
                    '<li class="satelite"><span style="background-color:#FED976;"></span><a href="#">10-20</a></li>' +
                    '<li class="outdoor"><span style="background-color:#FEB24C;"></span><a href="#">20-50</a></li>' +
                    '<li class="street"><span style="background-color:#FD8D3C;"></span><a href="#">50-100</a></li>' +
                    '<li class="light"><span style="background-color:#FC4E2A;"></span><a href="#">100-200</a></li>' +
                    '<li class="light"><span style="background-color:#E31A1C;"></span><a href="#">200-500</a></li>' +
                    '<li class="light"><span style="background-color:#BD0026;"></span><a href="#">500-1000 </a></li>' +
                    '<li class="light"><span style="background-color:#800026;"></span><a href="#">1000+</a></li>' +

                    '</ul>' +
                    '</div>';

                $('.legend-list').append(legend_html);
                // $('.bipad-logo').append(legend_html);




            }


            function isOdd(num) {
                return num % 2;
            }
            //calculate intervals between min and max values
            var range = function (start, end, step) {

                //
                // //
                var range = [];
                var typeofStart = typeof start;
                var typeofEnd = typeof end;

                if (step === 0) {
                    throw TypeError("Step cannot be zero.");
                }

                if (typeofStart == "undefined" || typeofEnd == "undefined") {
                    throw TypeError("Must pass start and end arguments.");
                } else if (typeofStart != typeofEnd) {
                    throw TypeError("Start and end arguments must be of same type.");
                }

                typeof step == "undefined" && (step = 1);

                if (end < start) {
                    step = -step;
                }

                if (typeofStart == "number") {

                    while (step > 0 ? end >= start : end <= start) {
                        if (end <= 10) {
                            range.push(start.toFixed(2));
                        } else {
                            range.push(Math.round(start));
                        }

                        start += step;
                    }
                    if (isOdd(Math.round(end))) {
                        if (end <= 10) {
                            range.push(end.toFixed(2));
                        } else {
                            range.push(Math.round(end));
                        }
                    }

                } else if (typeofStart == "string") {

                    if (start.length != 1 || end.length != 1) {
                        throw TypeError("Only strings with one character are supported.");
                    }

                    start = start.charCodeAt(0);
                    end = end.charCodeAt(0);

                    while (step > 0 ? end >= start : end <= start) {
                        range.push(String.fromCharCode(start));
                        start += step;
                    }

                } else {
                    throw TypeError("Only string and number types are supported");
                }

                return range;

            }




            function loadHdiData(risk_id, id, parent_id, name) { //loding socia data in map layers
                ////



                $('#' + id).addClass('loaded_layer');
                fed_url_api = base_url + "/risk_profile/Risk/" + risk_id;

                // socioid1=socioid.split("_")[0]+socioid.split("_")[1].charAt(0).toUpperCase()+socioid.split("_")[1].slice(1);
                ////////
                $.ajax({
                    // async:false,
                    url: fed_url_api,
                    success: function (result) {
                        ////
                        var fieldname = "avg";
                        var sum = result.sum;
                        // //////
                        // //////
                        if (risk_id != "hdi" && risk_id != "remoteness") {
                            var avg_val = (Math.round((result[fieldname] / sum) * 100));
                        } else {
                            var avg_val = (Math.round((result[fieldname]) * 100));
                        }

                        //  //////
                        // var features = district._layers;
                        var visual_html = '';

                        if ($('#' + id).hasClass('nt_loaded')) {
                            //
                            //map.addLayer(vt_label_district);
                            if (map.hasLayer(label)) {
                                map.removeLayer(label);
                            }
                            //  //////
                            //district.setFeatureStyle(result.results[i]["districtId"], riskStyle(parseFloat(result.results[i]['hdi'])));


                            for (var i = 0; i < result.results.length; i++) {

                                if (risk_id != "hdi" && risk_id != "remoteness") {
                                    val_per = Math.round((result.results[i][risk_id] / sum) * 100);
                                    val_max_per = Math.round((result.max / sum) * 100);
                                    val = Math.round((val_per / val_max_per) * 100);
                                    ////
                                } else {

                                    val = Math.round((result.results[i][risk_id]) * 100);
                                }
                                visual_html += '<div class="progress-warpper">' +
                                    '<div class="progress skill-bar ">' +
                                    '<div class="progress-bar progress-bar-success" role="progressbar" style="width:' + val + '%;" aria-valuenow="' + result.results[i][risk_id] + '" aria-valuemin="0" aria-valuemax="100">' +
                                    '</div>' +
                                    '</div>' +
                                    '<span class="skill">' + result.results[i]['district'] + ' :<i class="val">' + result.results[i][risk_id] + '</i></span>' +
                                    '</div>';
                                if (risk_id != "hdi" && risk_id != "remoteness") {
                                    // //
                                    district.setFeatureStyle(result.results[i]["districtId"], earthRiskStyle(result.results[i][risk_id], result.max, result.min));
                                } else {
                                    district.setFeatureStyle(result.results[i]["districtId"], riskStyle(parseFloat(result.results[i][risk_id])));
                                }




                                //  //////

                                //features[feature].feature.socioValue = parseFloat(result.results[i][risk_id]);
                                ////////





                            }

                            $('#' + parent_id).attr('data-currentLayer', 'district')
                            $('#' + parent_id).attr('data-result', JSON.stringify(result.results))
                            $('#' + parent_id).prop('checked', true);


                            visual_html += '<div class="barchart-line" style="left:' + avg_val + '%">' +
                                '<span class="average-text"> National Average</span>' +
                                '</div>';
                            ////////
                            ////////


                            $('.progress-list').html(visual_html);





                            //
                            var intervals = range(result.min, result.max, (result.max - result.min) / 5);
                            var color_range = ["#FED976", "#FD8D3C", "#E31A1C", "#BD0026", "#800026"];
                            // //
                            ////


                            //creating legend-list
                            //////
                            var legend_html = '<div class="legend-wrapper">' +
                                '<div class="buffer-header">' +
                                '<h4>' + name.replace("_", " ") + '</h4>' +
                                '<span><i class="ion ion-md-close"></i></span>' +
                                '</div>' +
                                '<ul>';
                            if (risk_id != "hdi" && risk_id != "remoteness") {
                                ////
                                for (var u = 0; u < intervals.length - 1; u++) {
                                    legend_html += '<li class="satelite"><span style="background-color:' + color_range[u] + ';"></span><a href="#">' + intervals[u] + ' - ' + intervals[u + 1] + '</a></li>';
                                    // //
                                    if (u > 3) {
                                        // //
                                        break;
                                    }
                                }
                                // legend_html+='<li class="satelite"><span style="background-color:'+color_range[intervals.length+1]+';"></span><a href="#">0-'+result.max+'</a></li>';
                                // '<li class="satelite"><span style="background-color:#FD8D3C;"></span><a href="#">'+(result.max/5).toFixed(2)+'-'+(result.max/4).toFixed(2)+'</a></li>'+
                                // '<li class="outdoor"><span style="background-color:#E31A1C;"></span><a href="#">'+(result.max/4).toFixed(2)+'-'+(result.max/3).toFixed(2)+' </a></li>'+
                                // '<li class="street"><span style="background-color:#BD0026;"></span><a href="#">'+(result.max/3).toFixed(2)+'-'+(result.max/2).toFixed(2)+' </a></li>'+
                                // '<li class="light"><span style="background-color:#800026;"></span><a href="#">'+(result.max/2).toFixed(2)+'-'+(result.max/1).toFixed(2)+' </a></li>';

                            } else {

                                legend_html += '<li class="satelite"><span style="background-color:#FED976;"></span><a href="#">0-0.2</a></li>' +
                                    '<li class="satelite"><span style="background-color:#FEB24C;"></span><a href="#">0.2-0.4</a></li>' +
                                    '<li class="outdoor"><span style="background-color:#FD8D3C;"></span><a href="#">0.4-0.6</a></li>' +
                                    '<li class="street"><span style="background-color:#FC4E2A;"></span><a href="#">0.6-0.8</a></li>' +
                                    '<li class="light"><span style="background-color:#E31A1C;"></span><a href="#">0.8-0.9</a></li>' +
                                    '<li class="light"><span style="background-color:#BD0026;"></span><a href="#">0.9-1</a></li>' +
                                    '<li class="light"><span style="background-color:#800026;"></span><a href="#"> 1+ </a></li>';
                            }



                            legend_html += '</ul>' +
                                '</div>';

                            $('.legend-list').append(legend_html);

                            //legend end





                            $('#' + id).removeClass('nt_loaded');

                        } else {
                            //
                            // map.removeLayer(vt_label_district);
                            filterapplied = CheckFilterApplied();
                            if (map.hasLayer(label) || filterapplied == true) {
                                map.addLayer(label);
                                //
                            } else if (label != null) {
                                //
                                //
                                map.addLayer(label);
                            }

                            for (var i = 0; i < result.results.length; i++) {
                                district.setFeatureStyle(result.results[i]["districtId"], resetStyle());
                            }
                            map.removeLayer(vt_label_district);
                            map.removeLayer(district);
                            //district.setFeatureStyle(result.results[i]["districtId"], resetStyle());
                            $('.legend-list').html('');
                            $('#' + parent_id).attr('data-currentLayer', '');
                            $('#' + parent_id).attr('data-result', '');
                            $('#' + parent_id).prop('checked', false);

                            $('#' + id).addClass('nt_loaded');
                        }


                        $('.loader').css('display', 'none');
                    }
                });



            }





            function generateSubcategoryChart(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label) {
                ////
                // console.log(data, "data");
                // console.log(total_sum, "total_sum");
                // console.log(layerName, "layerName");
                // console.log(filter_resources, "filter_resources");
                // console.log(filter_resources_range, "filter_resources_range");
                // console.log(layer_icon, "layer_icon");
                // console.log(level, "level");
                var html = "";
                // //

                for (var i = 0; i < data.length; i++) {

                    html += '<div class="progress-warpper">' +
                        '<div class="custom-control custom-checkbox">' +

                        '<input type="checkbox" class="custom-control-input sub_cat_ex changeclick ' + layerName + '_child" value="' + layerName + '" data-sub="' + data[i].label.replace(' ', '_') + '" id="progress_' + i + '" data-icon="' + layer_icon + '" name="' + layerName + '" checked></input>' +
                        '<label class="custom-control-label" for="progress_' + i + '" data-tab="capacity-popup"> </label>' +
                        '</div>' +
                        '<div class="progress-title">' +
                        '<label>' + data[i].label.replace("_", " ") + ' </label>' +
                        '<i class="ion ion-md-information-circle" data-toggle="popover" data-content=""></i>' +
                        // '<div class="info">'+
                        //     '<div class="info-content">'+
                        //         'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc placerat egestas ipsum, nec consequat mi euismod porttitor. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Proin porta iaculis nisi accumsan faucibus. Donec elementum risus sit amet lectus cursus, non dictum mauris pretium.'+
                        //   '</div>'+
                        '</div>' +

                        '<div class="progress skill-bar">' +
                        '<div class="progress-bar progress-bar-success" role="progressbar" style="width:' + (parseInt(data[i].count) / total_sum) * 100 + '%;" aria-valuenow="' + (parseInt(data[i].count) / total_sum) * 100 + '" aria-valuemin="0" aria-valuemax="100">' +
                        '</div>' +
                        '</div>' +
                        '<span class="skill">currently showing :<i class="val">' + data[i].count + '</i></span>' +
                        '</div>' +
                        '</div>';

                }




                $('#subcatChartContainer').html(html);
                $("#capacity_title").empty();
                $("#capacity_title").append("<b>" + layerName + "</b>");
            }


            function generateSubcategorySwitch(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label) {
                //
                filter_arr = filter_resources.split(",");
                filter_arr_range = filter_resources_range.split(",");
                filter_label = filter_range_label.split(",");

                console.log(filter_range_label, 'labelllll');
                // 
                // 
                //  //////
                var html = '<h4>Filter</h4>';
                html += '<div class="filter-list">';
                html += '<ul>';
                //


                // for (var i = 0; i < filter_arr.length; i++) {
                //     
                //     if (filter_arr[i].replace(/\s/g, "_") == 'noOfStaffs' || filter_arr[i].replace(/\s/g, "_") == 'bedCount') {
                //         //
                //         html += '<div id="slider' + i + '" class="slider filter_resource_btn" value="' + filter_arr[i].replace(/\s/g, "_") + '" data-icon="' + layer_icon + '" data-sum="' + total_sum + '" name="' + layerName + '" data-max="0" data-min="100"></div>'
                //         // html+='<div class="filter-list">'+
                //         //   '<h4 style="margin-top:1rem">Bed capacity</h4>'+
                //         //   '<div class="slider filter_resource_btn">'+
                //         //       '<input type="text" class="amount filter_resource_btn" value="'+filter_arr[i].replace(/\s/g,"_")+'" data-icon="'+layer_icon+'" name="'+layerName+'" />'+
                //         //       '<div class="slider-range filter_resource_btn" value="'+filter_arr[i].replace(/\s/g,"_")+'" data-icon="'+layer_icon+'" name="'+layerName+'"></div>'+
                //         //   '</div>'+
                //         // '</div>';

                //     } else {

                //         html += '<li>' +
                //             '<a href="#">' + filter_arr[i] + '</a>' +
                //             // '<button type="button" class="btn btn-sm btn-toggle filter_resource_btn" value="'+filter_arr[i]+'" name="'+layerName+'" data-toggle="button" aria-pressed="false" autocomplete="off">'+
                //             //     '<div class="handle"></div>'+
                //             //  '</button>'+
                //             '<label class="switch">' +
                //             '<input type="checkbox" class="filter_resource_btn" value="' + filter_arr[i].replace(/\s/g, "_") + '" data-icon="' + layer_icon + '" data-sum="' + total_sum + '" name="' + layerName + '"> </input>' +
                //             '<span class="slider-handle round"></span>' +
                //             '</label>' +
                //             // '<input type="checkbox" class="filter_resource_btn" value="'+filter_arr[i]+'" name="'+layerName+'"> </input>'+
                //             '</li>';
                //     }

                // }





                for (var i = 0; i < filter_arr.length; i++) {
                    html += '<li>' +
                        '<a href="#">' + filter_arr[i] + '</a>' +
                        // '<button type="button" class="btn btn-sm btn-toggle filter_resource_btn" value="'+filter_arr[i]+'" name="'+layerName+'" data-toggle="button" aria-pressed="false" autocomplete="off">'+
                        //     '<div class="handle"></div>'+
                        //  '</button>'+

                        '<label class="switch">' +
                        '<input type="checkbox" class="sub_cat_ex_radio changeclick filter_resource_btn" value="' + filter_arr[i].replace(/\s/g, "_") + '" data-icon="' + layer_icon + '" data-sum="' + total_sum + '" name="' + layerName + '"> </input>' +
                        '<span class="slider-handle round"></span>' +
                        '</label>' +
                        // '<input type="checkbox" class="filter_resource_btn" value="'+filter_arr[i]+'" name="'+layerName+'"> </input>'+
                        '</li>';
                }

                for (var j = 0; j < filter_arr_range.length; j++) {

                    html += '<hr><label><b>' + filter_label[j] + '</b></label><div id="slider' + j + '" class="slider filter_resource_btn" value="' + filter_arr_range[j].replace(/\s/g, "_") + '" data-icon="' + layer_icon + '" data-sum="' + total_sum + '" name="' + layerName + '" data-slider="' + filter_arr_range[j].replace(/\s/g, "_") + '"></div>'

                }


                // html+='<div class="filter-list">'+
                //   '<h4 style="margin-top:1rem">Bed capacity</h4>'+
                //   '<div class="slider">'+
                //       '<input type="text" class="amount" />'+
                //       '<div class="slider-range"></div>'+
                //   '</div>'+
                // '</div>';




                html += '</ul>';

                $('#subcatSwitchContainer').html(html);


            }

            function createSubcategoryChart(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label) {

                // //////
                $('.progress-bar').css('background-color', '#1672c6');
                if (level == 'both') {
                    //
                    generateSubcategoryChart(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label);
                    generateSubcategorySwitch(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label);

                } else if (level == 'subcategory') {

                    generateSubcategoryChart(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label);

                } else {
                    //

                    generateSubcategorySwitch(data, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label);
                }



                //waiting for element to created

                // setTimeout(function(){


                function maxRange(temp_array, feature_data) {
                    for (var o = 0; o <= feature_data.length; o++) {
                        var maxval = Math.max(...temp_array);
                        var minval = Math.min(...temp_array);
                        // 
                        // 
                        // 
                        return [minval, maxval + 1];
                        // var tempvalue = temp_array;
                        // 
                        // 
                    }
                }

                $(".slider").each(function () {


                    var $this = $(this).parent().children();
                    var id = $(this).attr('id');
                    var ranger = document.getElementById(id);
                    var data_slider = $(this).attr('data-slider');

                    // //
                    //nouislider

                    if ($(ranger).attr('value') != 'None') {
                        var ranges = document.getElementById(id);



                    }
                    else {
                        var ranges = document.getElementById('slider0');

                        return;
                    }


                    ////
                    // var minVal = 0;
                    // var maxVal = 100;
                    // function findMinMax(totalrange) {
                    //     let min = totalrange[0], max = totalrange[0];

                    //     for (let i = 1, len = totalrange.length; i < len; i++) {
                    //         let v = totalrange[i];
                    //         min = (v < min) ? v : min;
                    //         max = (v > max) ? v : max;
                    //     }

                    //     return [min, max];
                    //     
                    //     
                    // }
                    var layer_name = $(this).attr('name');
                    var sliderMaxRange = $("#slider2").data('max');
                    var sliderMinRange = $("#slider2").data('min');
                    var parsemax = parseInt(sliderMaxRange);
                    var parsemin = parseInt(sliderMinRange);
                    // 
                    // 
                    // 
                    // 
                    var feature_data = [];
                    var layers_data = [];
                    $.each(window[layer_name]._layers, function (feature) {
                        // 
                        feature_data.push(feature);
                        //  //
                        // feature_data.push(window[feature]._layers);

                    });
                    // 
                    for (var i = 0; i < feature_data.length; i++) {
                        layers_data.push(window[layer_name]._layers[feature_data[i]].feature.properties[data_slider]);
                    }

                    // 
                    var rangeVal = maxRange(layers_data, feature_data);
                    // 
                    // 
                    // 




                    noUiSlider.create(ranges, {
                        start: [rangeVal[0], rangeVal[1]],
                        connect: true,
                        tooltips: true,
                        decimals: 0,
                        range: {
                            // 'min': rangeVal[0],
                            // 'max': rangeVal[1]
                            'min': rangeVal[0],
                            'max': rangeVal[1]
                        },



                    }).on("set.one", function () {

                        // 
                        var id_slider = $(this)[0]['target'].id;
                        var id_slider1 = document.getElementById(id_slider);
                        current_value_array = id_slider1.noUiSlider.get();
                        // 
                        // 
                        var parsedMaxValue = parseInt(current_value_array[1]);
                        var parsedMinValue = parseInt(current_value_array[0]);
                        var totalrange = range(parsedMinValue, parsedMaxValue, (parsedMaxValue - parsedMinValue) / 5);
                        // 
                        // 
                        // 
                        // var getmaxmin = findMinMax(totalrange);
                        // 
                        // $("#slider2").attr("data-min", getmaxmin[0]);
                        // $("#slider2").attr("data-max", getmaxmin[1]);


                        // //
                        //////

                        //////


                        var layerName = $('#' + id_slider).attr('name');
                        var layer_icon = $('#' + id_slider).attr('data-icon');
                        var total_sum = $('#' + id_slider).attr('data-sum');
                        var fieldname = $('#' + id_slider).attr('value');
                        // 

                        //function
                        var features_data = [];
                        var sub_layer_name = [];

                        if (map.hasLayer(window["filter_resource_" + layerName])) {
                            ////////

                            map.removeLayer(window["filter_resource_" + layerName]);

                        }
                        // 
                        $.each($('.sub_cat_ex:checked'), function () {

                            var name_sub = $(this).attr('data-sub');

                            if (name_sub == undefined) {
                                name_sub = $(this).attr('value');
                            }
                            // 
                            sub_layer_name.push(name_sub);


                            // 
                            // 
                            // var layersdata = window[name_sub]._layers;
                            // 
                            ////////
                            // $.each(layersdata, function (feature) {

                            //     //  //
                            //     features_data.push(layersdata[feature].feature);

                            // });
                            // 

                        });

                        // var layer_data1 = {
                        //     "type": "FeatureCollection",
                        //     "features": features_data

                        // };


                        //

                        //layer_data1=window[layerName].toGeoJSON();
                        // //////
                        // var layer_data = jQuery.extend(true, {}, layer_data1);
                        ////
                        var checkedList = [];
                        $.each($("input[class='filter_resource_btn']:checked"), function () {

                            checkedList.push($(this).val());
                        });

                        // 
                        // var temp_array = id_slider1.noUiSlider.get();

                        // maxRange(temp_array, totalrange);
                        //  ////////
                        // ////////
                        // 
                        // 
                        // if (checkedList.length > 0) {

                        //     
                        //     for (var k = layer_data.features.length - 1; k >= 0; k--) {
                        //         var delete_count = 0;
                        //         for (var i = 0; i < checkedList.length; i++) {

                        //             // 
                        //             // 
                        //             // 
                        //             // 
                        //             // 
                        //             if (layer_data.features[k].properties[checkedList[i].trim().toLowerCase()] == true && layer_data.features[k].properties[checkedList[i].trim().toLowerCase()] != false) {
                        //                 
                        //                 // if(layer_data.features[k].properties[fieldname]>current_value_array[0] && layer_data.features[k].properties[fieldname]<current_value_array[1]){
                        //                 delete_count++;
                        //                 ////////

                        //                 // }

                        //             }
                        //         }
                        //         ////////
                        //         if (delete_count == 0) {
                        //             ////////
                        //             ////////
                        //             ////////
                        //             layer_data.features.splice(k, 1);

                        //         }


                        //     }

                        // }

                        // var new_layer_data = jQuery.extend(true, {}, layer_data);
                        // var delete_count_slider = 0;
                        // // 
                        // // 
                        // //  //
                        // for (var l = layer_data.features.length - 1; l >= 0; l--) {
                        //     // 
                        //     delete_count_slider = 0;
                        //     // 
                        //     // 
                        //     // 
                        //     // 
                        //     // 

                        //     if (layer_data.features[l].properties[fieldname] >= parsedMinValue && layer_data.features[l].properties[fieldname] <= parsedMaxValue) {
                        //         // 
                        //         delete_count_slider++;
                        //     }
                        //     else {
                        //         // 
                        //     }

                        //     if (delete_count_slider == 0) {
                        //         // 
                        //         layer_data.features.splice(l, 1);
                        //     }

                        // }
                        // for (var l = layer_data.features.length - 1; l >= 0; l--) {
                        //     
                        //     if (layer_data.features[l].properties[fieldname] > parseInt(current_value_array[0]) && layer_data.features[l].properties[fieldname] < parseInt(current_value_array[1])) {
                        //         // //
                        //         delete_count_slider++;
                        //     }

                        //     if (delete_count_slider == 0) {
                        //         layer_data.features.splice(l, 1);
                        //     }

                        // }


                        // // 
                        // //map.removeLayer(window["filter_resource_" + layerName]);
                        // //map.removeLayer(window["filter_resource_marker_" + layerName]);
                        // if (map.hasLayer(window[layerName + "_markers"]) || map.hasLayer(window[layerName])) {
                        //     map.removeLayer(window[layerName + "_markers"]);
                        //     map.removeLayer(window[layerName]);

                        // }

                        // 
                        // filtermap(layer_data, checkedList, sub_layer_name, total_sum, layerName, layer_icon);


                        //function

                        // 
                        geojson_data = window[layer_name].toGeoJSON();


                        filter_check(geojson_data, id_slider, fieldname, parsedMinValue, parsedMaxValue, layer_icon)


                    });



                    //nouislider end

                    //$this is a reference to .slider in current iteration of each

                    //find any .slider-range element WITHIN scope of $this
                    // $(".slider-range", $this).slider({
                    //     range: true,
                    //     min: 0,
                    //     max: 1000,
                    //     values: [300, 600],
                    //     slide: function (event, ui) {
                    //         // find any element with class .amount WITHIN scope of $this
                    //         $(".amount", $this).val( ui.values[0] + " - " + ui.values[1]);
                    //     }
                    // });
                    // $(".amount").val($(".slider-range").slider("values", 0) + " - " + $(".slider-range").slider("values", 1));

                });
                // }, 100);

                //end

            }

            //FILTERCHECK FUNCTION START
            function filter_check(geojsons, id_slider, fieldname, parsedMinValue, parsedMaxValue, layer_icon) {
                //  
                var geojson_array = [];
                var layersdata = window[layerName]._layers;

                //////
                // $.each(layersdata, function (feature) {

                //     //  //
                //     geojson_array.push(layersdata[feature].feature);

                // });


                // var geojsons = {
                //             "type": "FeatureCollection",
                //             "features": geojson_array

                //         };



                var features_data = [];
                var checkbox_list = [];
                var radio_list = [];

                $.each($('.sub_cat_ex:checked'), function () {

                    var name_sub = $(this).attr('data-sub');


                    // if (name_sub == undefined) {
                    //     var name_sub = $(this).attr('value');
                    // }
                    // var layersdata = window[name_sub]._layers;

                    checkbox_list.push(name_sub);

                    // $.each(layersdata, function (feature) {
                    //     features_data.push(layersdata[feature].feature);
                    // });

                });
                $.each($('.sub_cat_ex_radio:checked'), function () {
                    fieldname
                    var name_sub = $(this).attr('value');

                    // var layersdata = window[name_sub]._layers;

                    radio_list.push(name_sub);

                    // $.each(layersdata, function (feature) {
                    //     features_data.push(layersdata[feature].feature);
                    // });

                });

                //Slider  Value on icu and ncu radio button CLick Start

                var slider_array = [];
                var attr = [];
                var object = {};
                var slider = document.getElementsByClassName('slider');
                // 
                if ($(slider).attr('value') != 'None') {
                    for (var i = 0; i < slider.length; i++) {
                        var sliderOptions = slider[i].noUiSlider.get();
                        // 
                        // slider_array.push(slider[i].getAttribute('data-slider'), sliderOptions,);
                        object[slider[i].getAttribute('data-slider')] = sliderOptions;

                    }
                }

                slider_array.push(object);
                // 
                // $("#slider0").click(function () {

                // });
                // 
                // 
                // 
                console.log(radio_list, 'radio');
                console.log(checkbox_list, 'checkbox');
                // CreateChartData(geojsons, checkbox_list, null, 'both', 3, layerName, null, null, 'humanitarian-icon-Hospital')

                //     // CreateChartData(geojson,subcat,charttype,level,total_sum,layerName,filter_resources,layer_icon)





                //     // CreateChartData(layer_data,checkedList,'bar','filter');
                prepareData(checkbox_list, slider_array, radio_list, id_slider, fieldname, parsedMinValue, parsedMaxValue, geojsons, layer_icon)
            }


            //FILTERCHECK FUNCTION END

            //
            $('#capacity-popup').on('click', '.changeclick', function () {

                var name_sub = $(this).attr('name');
                var layer_icon = $(this).attr('data-icon');
                // 
                // 
                geojson_data = window[name_sub].toGeoJSON()
                filter_check(geojson_data, null, null, null, null, layer_icon);


                //Slider  Value on icu and ncu radio button CLick END
            });

            //DATA PREPARING FOR FILTERCHECK FUNCTION START
            // var layer_data = jQuery.extend(true, {}, layer_data1);

            // 
            function prepareData(checkbox_list, slider_array, radio_list, id_slider, fieldname, parsedMinValue, parsedMaxValue, geojsons, layer_icon) {

                if (map.hasLayer(window["filter_resource_marker_" + layerName])) {
                    map.removeLayer(window["filter_resource_marker_" + layerName]);
                }
                // 
                // 
                // 
                filter_geojson = [];
                // var clones_geojsons= geojsons;
                var clones_geojsons = jQuery.extend(true, {}, geojsons);
                var clone_geojson = jQuery.extend(true, {}, geojsons);

                // 
                // var clone_geojson = geojsons;
                // 

                // 

                // 
                // 
                // 



                // for (var q = 0; q < clone_geojson.features.length; q++) {
                //     for (var j = 0; j < checkbox_list.length; j++) {
                //         var filteropt = checkbox_list[j].toLowerCase();
                //         // 
                //         // 
                //         if (clone_geojson.features[q].properties.type == filteropt) {
                //             
                //             filter_geojson.push(clone_geojson.features[q])
                //         }
                //     }
                //     for (var k = 0; k < radio_list.length; k++) {
                //         var filter_radio = radio_list[k].toLowerCase();

                //         // 
                //         if (clone_geojson.features[q].properties[filter_radio] == true) {
                //             
                //             filter_geojson.push(clone_geojson.features[q])
                //         }
                //     }
                // }



                if (checkbox_list.length > 0) {

                    for (var k = clones_geojsons.features.length - 1; k >= 0; k--) {
                        var delete_count = 0;
                        for (var i = 0; i < checkbox_list.length; i++) {
                            // 
                            // 
                            // 


                            if (clones_geojsons.features[k].properties.type.trim().toLowerCase().replace(' ', '') == checkbox_list[i].trim().toLowerCase().replace('_', '')) {

                                delete_count++;


                            }
                        }
                        if (delete_count == 0) {

                            clones_geojsons.features.splice(k, 1);

                        }


                    }

                }



                if (radio_list.length > 0) {

                    for (var k = clones_geojsons.features.length - 1; k >= 0; k--) {
                        var delete_count = 0;
                        for (var i = 0; i < radio_list.length; i++) {

                            if (clones_geojsons.features[k].properties[radio_list[i].trim().toLowerCase()] == true && clones_geojsons.features[k].properties[radio_list[i].trim().toLowerCase()] != false) {

                                delete_count++;


                            }
                        }
                        if (delete_count == 0) {
                            clones_geojsons.features.splice(k, 1);

                        }


                    }

                }


                // 
                var delete_count_slider = 0;
                if (id_slider != undefined) {
                    for (var l = clones_geojsons.features.length - 1; l >= 0; l--) {

                        delete_count_slider = 0;






                        if (clones_geojsons.features[l].properties[fieldname] >= parsedMinValue && clones_geojsons.features[l].properties[fieldname] <= parsedMaxValue) {
                            // 
                            delete_count_slider++;
                        }
                        else {
                            // 
                        }

                        if (delete_count_slider == 0) {
                            // 
                            clones_geojsons.features.splice(l, 1);
                        }

                    }
                }












                var full_filter_data = clones_geojsons;

                window["filter_resource_marker_" + layerName] = null;

                window["filter_resource_marker_" + layerName] = L.markerClusterGroup({
                    disableClusteringAtZoom: 12,
                    clusterPane: 'pointsPane'
                });

                ////////
                window["filter_resource_" + layerName] = new L.geoJson(clones_geojsons, {

                    pointToLayer: function (feature, Latlng) {

                        var divicon = L.divIcon({
                            className: layer_icon

                        });
                        var marker = L.marker(Latlng, {
                            icon: divicon
                        });


                        window["filter_resource_marker_" + layerName].addLayer(marker);
                        return marker;

                        // return marker;
                    },
                    onEachFeature: function (feature, layer) {


                        var contentString = createPopup(feature, layerName);
                        layer.bindPopup(L.popup({
                            //closeOnClick: true,
                            //closeButton: true,
                            keepInView: true,
                            autoPan: true,
                            maxHeight: 200,
                            minWidth: 250,
                            pane: "topPane"
                        }).setContent(contentString));

                    }

                });
                map.removeLayer(window[layerName]);
                // map.removeLayer(window[layerName + '_markers']);
                window["filter_resource_marker_" + layerName].addTo(map);

            }


            // features_data.push(layersdata[feature].feature);

            //         });

            //     });

            //     var layer_data1 = {
            //         "type": "FeatureCollection",
            //         "features": features_data

            //     };


            //DATA PREPARING FOR FILTERCHECK FUNCTION END
            //function chart-bar
            function CreateChartData(geojson, subcat, charttype, level, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, filter_range_label) {
                console.log(geojson, "geojson");
                console.log(subcat, "subcat");
                console.log(charttype, "charttype");
                console.log(level, "level");
                console.log(total_sum, "total_sum");
                console.log(layerName, "layerName");
                console.log(filter_resources, "filter_resources");
                console.log(filter_resources_range, "filter_resources_range");
                console.log(layer_icon, "layer_icon");
                // //
                //
                features = geojson.features;
                //  subcat_arr=subcat.split(",");
                subcat_arr = subcat;
                //  //////
                var chartData = [];
                //subcat_arr_count =[];
                for (var k = 0; k < subcat_arr.length; k++) {
                    ////////
                    //subcat_arr_count[k][subcat_arr[k]+"_count"] = 0;
                    chartData.push({
                        "label": subcat_arr[k].trim(),
                        "count": 0
                    });

                }
                ////////
                ////
                $.each(features, function (feature) {
                    // //
                    for (var i = 0; i < subcat_arr.length; i++) {
                        ////
                        if (level == 'subcategory' || level == 'both') {
                            ////
                            if (subcat_arr[i].trim() == features[feature].properties.type.trim()) {
                                chartData[i].count++;


                            }
                        } else {
                            ////
                            ////
                            ////////
                            if (features[feature].properties[subcat_arr[i]].trim() == 'yes') {
                                ////////
                                chartData[i].count++;


                            }
                        }


                    }



                });
                ////

                createSubcategoryChart(chartData, total_sum, layerName, filter_resources, filter_resources_range, layer_icon, level, filter_range_label);
                // if(charttype=='pie'){
                //
                //   createChart(chartData);
                // }else{
                //   createBarChart(chartData,'barchart');
                // }

            }



            //add legend

            function addLegend(legend_content) {

                if (legend_content == "earthquake") {

                    var url = "{% static 'mappage/images/earthquake_legend.png' %}";

                } else {
                    //////
                    //////
                    var url = geo_url + '?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=20&HEIGHT=10&&crossOrigin=Anonymous&LAYER=' + legend_content + '&';
                }
                var legend_name1 = legend_content.replace(/_/g, " ");
                var legend_name = legend_name1.charAt(0).toUpperCase() + legend_name1.slice(1);
                var legend_html = '<div class="legend-wrapper">' +
                    '<div class="buffer-header">' +
                    '<h4>' + legend_name + '</h4>' +
                    // '<h4>Flood Depth</h4>' +
                    '<span><i class="ion ion-md-close"></i></span>' +
                    '</div>' +
                    '<ul>' +
                    '<li class="satelite"></span><img src="' + url + '"></img></li>' +


                    '</ul>' +
                    '</div>';

                $('.legend-list').html(legend_html);

            }


            //end

            // required functions end




            //acccess to communication
            $(".socio").on('click', function () {
                $('.loader').css('display', 'block');
                filterapplied = CheckFilterApplied();
                removeAllLayers();
                if (filterapplied == true) {
                    map.addLayer(federal_boundary);
                    map.addLayer(Mask);
                    //map.addLayer(label);

                } else {
                    // map.flyTo([28.410728397237914, 84.4024658203125], 8);
                    map.fitBounds(province_bbox);
                }
                var id = $(this).attr("id");
                $('.legend-list').html('');
                var parent_id = $(this).attr("data-parent");
                ////////
                loadSocioData(id, parent_id);


            });
            $(".vul_hdi").on('click', function () {
                $('.loader').css('display', 'block');
                filterapplied = CheckFilterApplied();
                removeAllLayers();


                if (filterapplied == true) {
                    map.addLayer(federal_boundary);
                    map.addLayer(Mask);
                    //map.addLayer(label);

                } else {
                    // map.flyTo([28.410728397237914, 84.4024658203125], 8)
                    map.fitBounds(province_bbox);
                    // map.removeLayer(federal_boundary);
                }
                var id = $(this).attr("data-score");
                var id_input = $(this).attr("id");
                var parent_id = $(this).attr("data-parent");
                var name = $(this).attr("data-legendname");
                $('.legend-list').html('');
                ////////

                loadHdiData(id, id_input, parent_id, name);


            });

            //end access


            $('.parent_vul').on('click', function () {



                // var this_id = ($(this).find("input").prevObject[0]).prop('id');
                var this_id = ($(this).attr('id'));
                // $('.admin_bound[data-parent="' + this_id + '"]').parent().toggleClass('custom-check ');
                $('.admin_bound[data-parent="' + this_id + '"]').parent().attr('class', 'custom-control custom-radio');
                $('.admin_bound[data-parent="' + this_id + '"]').attr('class', 'custom-control-input admin_bound vul_hdi loaded_layer nt_loaded');
                // $("#" + $(this).attr('id'));
                // 
                if ($(this).parent().prop('className') == 'custom-control custom-radio') {

                }
                else {

                    map.removeLayer(district);
                    map.removeLayer(vt_label_district);
                }
                var current_layer = $(this).attr('data-currentLayer');
                var resultt = $(this).attr('data-result');
                if (current_layer != "") {
                    var result = JSON.parse(resultt);
                    ////////
                    if (current_layer == 'municipality') {
                        dataid = 'municipalityId';
                        $(".socio").prop('checked', false);
                    } else {
                        dataid = 'districtId';
                    }
                    for (var i = 0; i < result.length; i++) {
                        window[current_layer].setFeatureStyle(result[i][dataid], resetStyle());
                    }
                    $(".vul_hdi").prop('checked', false);
                    $(".legend-list").html('');

                }


            })

            //end vulnerability map Layer

            //start of hazard layer

            var hazard_one_click = 0;
            var hazard_previous_id = '';
            previous_hazard_layer = null;


            $('#hazard_popup_html').on('click', '.hazard_geo', function () {
                $('.loader').css('display', 'block');

                filterapplied = CheckFilterApplied();
                removeAllLayers();
                if (filterapplied == true) {
                    map.addLayer(federal_boundary);
                    map.addLayer(Mask);
                    map.addLayer(label);

                }
                // else{

                // }
                //////
                var hazard_id = $(this).closest(".card").children()[0].id;
                var id = $(this).attr('data-workspace');
                var id_input = $(this).attr('id');
                var center = eval($(this).attr('data-center'));
                var layername = $(this).attr('data-layername');
                var current_layer = $(this).attr('data-layername');



                // var Earthquake_hazard =$("#Map00").parent()[0].className;
                ////
                //remove previous layer on radio change


                if ($(this).attr("haslayer")) {
                    //
                    //
                    //
                    var classname = $(this).parent().attr("class");
                    //
                    if (classname == 'custom-control custom-radio custom-check') {
                        ////
                        map.removeLayer(window[layername]);
                        $('.legend-list').html('');
                        $('.hazard_list').attr('hasLayer', false);
                        $('.hazard_list').attr('data-currentLayer', '');
                        $('.loader').css('display', 'none');

                        // map.flyTo([28.410728397237914,84.4024658203125], 7);
                    } else {
                        //
                        addLegend(layername);

                        //map.addLayer(window[layername]);
                        $('.hazard_list').attr('hasLayer', true);
                        $('.hazard_list').attr('data-currentLayer', layername);
                        window[layername].addTo(map);
                        //
                        //

                        if (previous_hazard_layer != null && previous_hazard_layer != window[layername]) {
                            $('.hazard_list').attr('hasLayer', false);
                            $('.hazard_list').attr('data-currentLayer', '');
                            map.removeLayer(previous_hazard_layer);

                        }

                        previous_hazard_layer = window[layername];
                        $('#' + hazard_id).parent().find('.center').attr('data-name-trans', layername);


                        //$('.center').attr('data-name-trans',layername);
                        ////////
                    }
                    $(this).attr("haslayer", false);
                } else {
                    //
                    ////

                    if (id == 'earthquake') {
                        var id_input_classname = $('#' + id_input).parent()[0].className;
                        // //
                        // //
                        if (id_input_classname == 'custom-control custom-radio custom-check') {
                            ////////
                            // $('.hazard_list').attr('hasLayer',false);
                            // $('.hazard_list').attr('data-currentLayer','');
                            // map.removeLayer();
                            //
                            $('.loader').css('display', 'none');
                        } else {
                            var num = 1;
                            //  //////
                            ////

                            // //

                            window[layername] = L.tileLayer('https://maps.openquake.org/tiles/ghm/wmts/seismic-hazard-pga-g/webmercator/{z}/{x}/{y}.png', {
                                // trick: expose name via options, used in events
                                name: 'Seismic Hazard PGA (g)',
                                overlay: true,
                                attribution: '',
                                legend: true,
                                printable: true,
                                zIndex: 9996,
                                ext: '/media/ext/js/global-hazard.js',
                                pane: "wmsPane",
                                maxZoom: 15,
                                minZoom: 2,

                            }).addTo(map).setOpacity(0.5);

                            if (filterapplied == true) {

                            } else {
                                // map.flyTo(center, 7);
                                // var earth_bbox = GetCapabilitiesGeoserver(layername, 'https://maps.openquake.org/tiles/ghm/wmts/seismic-hazard-pga-g/webmercator/{z}/{x}/{y}.png', id);
                                // //
                                map.fitBounds(province_bbox);
                            }



                            $('.hazard_list').attr('hasLayer', true);
                            $('.hazard_list').attr('data-currentLayer', layername);
                            addLegend(layername);
                            // $(this).attr("haslayer",false);

                            $('#' + hazard_id).parent().find('.center').attr('data-name-trans', layername);
                            //$('.center').attr('data-name-trans',layername);

                            // //

                            //removeAllLayers();
                            // //
                            // //
                        }

                    } else {
                        //  //////

                        geo_url = 'https://geoserver.naxa.com.np/geoserver/wms';

                        window[layername] = L.tileLayer.betterWms(geo_url, {
                            layers: id + ":" + layername,
                            transparent: true,
                            format: 'image/png',
                            pane: "wmsPane"
                        }).addTo(map);
                        // //
                        var flood_bbox = GetCapabilitiesGeoserver(layername, 'https://geoserver.naxa.com.np/geoserver', 'Bipad');
                        // //
                        // map.fitBounds(flood_bbox);

                        $('.hazard_list').attr('hasLayer', true);
                        $('.hazard_list').attr('data-currentLayer', layername);
                        // //
                        if (previous_hazard_layer != null && previous_hazard_layer != window[layername]) {
                            ////////
                            // $('.hazard_list').attr('hasLayer',false);
                            // $('.hazard_list').attr('data-currentLayer','');
                            map.removeLayer(previous_hazard_layer);
                        }
                        previous_hazard_layer = window[layername];

                        $(this).attr("haslayer", true);
                        //  //////
                        $('#' + hazard_id).parent().find('.center').attr('data-name-trans', layername);
                        addLegend(layername);
                        // $('.center').attr('data-name-trans',layername);

                        //   window[layername].on('load',function(){
                        //
                        // });


                        if (hazard_previous_id != hazard_id) {
                            hazard_one_click = 0;
                        }

                        //  //////
                        // if(hazard_one_click==0){
                        if (id == "Naxa:sankhu_drone") {
                            // map.flyTo(center, 18);
                            // var sankhu_bbox = GetCapabilitiesGeoserver(layername, 'https://apps.naxa.com.np/geoserver', 'Naxa');
                            // // //
                            // map.fitBounds(sankhu_bbox);

                        } else if (id == "Naxa:bancharedanda") {

                        } else {
                            // var flood_bbox = GetCapabilitiesGeoserver(layername, 'https://geoserver.naxa.com.np/geoserver', 'Bipad');
                            // // //
                            // map.fitBounds(flood_bbox);
                            // map.flyTo(center, 11);
                        }
                        hazard_one_click = 1;
                        // }


                    }
                    window[layername].on('load', function () {
                        $('.loader').css('display', 'none');
                        //////

                    })
                }

                hazard_previous_id = hazard_id;



            });



            //end of hazard layer

            //start of hazard layer

            //$('#exposure_popup').one('click', '.exposure_geo', function () {

            function exposureOneClick(layername, parent_id, center, id, geo_url, main_id) {
                // //

                $('.loader').css('display', 'block');
                filterapplied = CheckFilterApplied();
                removeAllLayers();
                if (filterapplied == true) {
                    map.addLayer(federal_boundary);
                    map.addLayer(Mask);
                    //map.addLayer(label);

                } else {

                }
                //var layername = $(this).attr('data-layername');
                //var layername = $(this).attr('data-layername');
                // //

                if (main_id == 'hydro_1') {
                    //  //////
                    var url = base_url + '/risk_profile/Hydro';
                    window[layername] = new L.geoJson.ajax(url, {

                        pointToLayer: function (feature, latlng) {

                            var marker = L.circleMarker(latlng, {
                                pane: "markerPane"
                            });
                            return marker;

                        },



                        onEachFeature: function (feature, layer) {
                            style = ({
                                fillColor: '#c1f441',
                                weight: 5,
                                opacity: 0.5,
                                color: '#871896',
                                radius: '5',
                                fillOpacity: 0.9

                            });


                            var contentString = createPopup(feature, layername);
                            layer.bindPopup(L.popup({
                                //closeOnClick: true,
                                //closeButton: true,
                                keepInView: true,
                                autoPan: true,
                                maxHeight: 200,
                                minWidth: 250,
                                pane: "topPane"
                            }).setContent(contentString));

                            layer.setStyle(style);
                        }

                    });

                    window[layername].on('data:loaded', function () {
                        map.addLayer(window[layername]);

                        $('.loader').css('display', 'none');
                        //

                    })

                } else {
                    // var id = $(this).attr('data-workspace');


                    // var geo_url = $(this).attr('data-url');
                    //

                    //

                    window[layername] = L.tileLayer.betterWms(geo_url, {
                        layers: id + ":" + layername,
                        transparent: true,
                        format: 'image/png',
                        pane: "wmsPane"
                    }).addTo(map);
                    window[layername].on('load', function () {
                        $('.loader').css('display', 'none');
                    });
                    //
                    // map.addLayer(window[layername]); 
                    setTimeout(function () {
                        // map.flyTo(center, 18)
                        //
                        var geo_url1 = geo_url;
                        if (geo_url.search("/wms") != -1) {
                            geo_url1 = geo_url.replace("/wms", "");
                        }

                        //
                        var infra_bbox = GetCapabilitiesGeoserver(layername, geo_url1, id);
                        // //
                        map.fitBounds(infra_bbox);

                        map.addLayer(window[layername]);
                        // $('.loader').css('display', 'none');

                        //
                    }, 4000);
                    //
                    // map.addLayer(window[layername]);
                    // $('.loader').css('display', 'none');
                    // window[layername].on('load', function () {
                    //   //
                    //   $('.loader').css('display', 'none');

                    // });


                    //////
                    // //////



                }


            }
            //});


            var exposureOneClickCount = 0;
            var previousExposureClick = null;
            $('.exposure_drone_pop').on('click', '.exposure_geo', function (e) {
                //

                filterapplied = CheckFilterApplied();
                var layername = $(this).attr('data-layername');
                var parent_id = $(this).attr('data-parent');
                var center = eval($(this).attr('data-center'));

                var id = $(this).attr('data-workspace');
                var main_id = $(this).attr('id')
                var geo_url = $(this).attr('data-url');
                //
                //



                if (layername != previousExposureClick) {
                    //
                    exposureOneClickCount = 0;
                }

                if (exposureOneClickCount == 0) {
                    //
                    $('.loader').css('display', 'none');
                    exposureOneClick(layername, parent_id, center, id, geo_url, main_id);
                }


                var count_check = 0;
                var haslayer = false;
                if (map.hasLayer(window[layername])) {
                    haslayer = true;
                } else {
                    haslayer = false;
                }
                removeAllLayers();
                if (filterapplied == true) {
                    map.addLayer(federal_boundary);
                    map.addLayer(Mask);
                    //map.addLayer(label);

                } else {

                }


                if ($(this).attr('id') == 'hydro_1') {
                    // //
                    //
                    // //////
                    if (haslayer) {
                        $('#' + parent_id).attr('data-currentLayer', '');
                        //////
                        // //
                        map.removeLayer(window[layername]);


                    } else {
                        $('#' + parent_id).attr('data-currentLayer', layername);
                        if (exposureOneClickCount != 0) {
                            map.addLayer(window[layername]);

                        }
                        ////
                        // map.flyTo([28.410728397237914, 84.4024658203125], 8)
                    }




                } else {
                    if (haslayer) {
                        $('#' + parent_id).attr('data-currentLayer', '');
                        map.removeLayer(window[layername]);
                        map.fitBounds(province_bbox);
                        // map.flyTo([28.410728397237914, 84.4024658203125], 8)
                    } else {
                        $('#' + parent_id).attr('data-currentLayer', layername);
                        //
                        if (exposureOneClickCount != 0) {
                            map.addLayer(window[layername]);
                        }
                        //
                        if ($(this).attr('id') == 'build_1') {
                            map.fitBounds(province_bbox);
                            // map.flyTo([28.410728397237914, 84.4024658203125], 8);
                        } else {

                            map.flyTo(center, 18);
                        }

                    }
                }

                previousExposureClick = layername;
                exposureOneClickCount++;
            });

            //end of hazard layer



            function createPopup(feature, layername) {
                ////////
                //popup content
                var contentString = '<div class="box box-primary" style="width:400px;">';
                // '<a href="#" style="background-color:  #337ab7; float:right; display: inline-block;" id="route" onclick="details('+feature.properties.id+')" class="btn btn-primary btn-xs"><b>View Details</b></a>'+
                //'<h6 class="profile-username text-center"></h6>';
                if (feature.properties['title'] != undefined) {
                    contentString += '<h6><b>' + feature.properties.title + '</b></h6>';
                } else if (feature.properties['name'] != undefined) {
                    contentString += '<h6><b>' + feature.properties.name + '</b></h6>';
                }

                contentString += '<ul class="list-group list-group-unbordered">';

                for (data in feature.properties) {

                    //  //////




                    if (data != 'title' || data != 'name' && data != 'pk') {
                        contentString += '<li class="list-group-item popup-list">';

                        contentString += '<b>' + data + ': </b> <a class="pull-right"> ' + feature.properties[data] + '</a></li>';
                    }
                    // else if(data != 'name' && data != 'pk' ){
                    //   contentString += '<li class="list-group-item popup-list">';

                    //   contentString += '<b>' + data + ': </b> <a class="pull-right"> ' + feature.properties[data] + '</a></li>';

                    // }

                    // '<li class="list-group-item"><b>House Head Name</b> <a class="pull-right">'+feature.properties.Head_of_the_Household
                    // +'</a></li>'+
                    // '<li class="list-group-item"><b>Received Support Type </b> <a class="pull-right">'+feature.properties.Any_support_after_earthquake
                    // +'</a></li>'+
                    // '<img src="'+feature.properties.Front_Facing_Photo+'" width="400" height="280" />'+


                }
                contentString += '</ul>';
                if (layername != "hydrpower") {
                    contentString += '<button style="display:flex; justify-content:center; margin:0.5rem auto 0 auto;"><a href="' + base_url + '/admin/risk_profile/' + layername.toLowerCase() + '/' + feature.properties['pk'] + '/change/" style="background-color:#337ab7; margin:0 auto; display: inline-block; color:#fff; padding:0.1rem 1rem; font-size:0.775rem; text-transform:uppercase;" class="btn btn-primary">Edit</a></button>';

                }
                contentString += '</div></div ></div > ';
                return contentString;
                //popup content stop


            }


            var sub_array = null;
            //start of resource layer
            $.get(base_url + '/risk_profile/Layer', function (data) {

                ////////

                //   //////
                var resources_loadCount = 1;
                for (var i = 0; i < data.results.length; i++) {
                    var url = base_url + "/risk_profile/Resources/" + data.results[i]['layername'];
                    layer_icon = data.results[i]['layerIcon']
                    type1 = data.results[i]['type'];
                    sub_array = data.results[i]['type'];
                    // //

                    ////

                    for (var j = 0; j < sub_array.length; j++) {
                        // //
                        window[sub_array[j]['type'].replace(' ', '_')] = L.layerGroup();
                        window[sub_array[j]['type'].replace(' ', '_') + '_markers'] = L.markerClusterGroup({
                            disableClusteringAtZoom: 12,
                            clusterPane: 'pointsPane',
                        });
                        //  //
                    }
                    console.table(data.results[i], "alladata");
                    $.ajax({
                        url: url,
                        //data:{"layer_icon":layer_icon, "data":data,"i":i},
                        //data:{"layer_icon":layer_icon, "data":data,"i":i},

                        data1: data.results[i],
                        indexValue: i,
                        layer_icon: layer_icon,
                        type2: type1,
                        complete: function () {
                            ////
                            if (data.results.length == resources_loadCount) {
                                $('.loader').css('display', 'none');
                            }
                            resources_loadCount++;
                        },
                        success: function (response) {
                            // //

                            var layer_icon1 = this.layer_icon;
                            var type = this.type2;
                            // //

                            var dataList = this.data1;
                            //////
                            var layername = this.data1['layername'];
                            // //
                            //creating cluster names
                            window[layername + '_markers'] = L.markerClusterGroup({
                                disableClusteringAtZoom: 12,
                                clusterPane: 'pointsPane',
                                // iconCreateFunction: function (cluster) {
                                //     var markers = cluster.getAllChildMarkers();
                                //     //
                                //     var n = 0;
                                //     for (var i = 0; i < markers.length; i++) {
                                //         n += markers[i].number;
                                //     }
                                //     //return L.divIcon({ html: n, className: className, iconSize: L.point(40, 40) });
                                // }
                            });


                            window[layername] = new L.geoJson(response, {
                                // pane:"polygonsPane",
                                pointToLayer: function (feature, Latlng) {

                                    // var divicon = L.divIcon({
                                    //     className: layer_icon1
                                    //
                                    // });

                                    ////
                                    var divicon = L.divIcon({
                                        html: '<div class="image-icon"></div>',
                                        // Specify a class name we can refer to in CSS.
                                        className: layer_icon1,
                                        // Set a markers width and height.
                                        //iconSize: [52, 52],
                                        iconAnchor: [4, 2],
                                        // pane:"polygonsPane"
                                    });

                                    var marker = L.marker(
                                        Latlng, {
                                            icon: divicon,
                                            pane: "markerPane"
                                        });

                                    var contentString = createPopup(feature, layername);
                                    marker.bindPopup(L.popup({
                                        //closeOnClick: true,
                                        //closeButton: true,
                                        keepInView: true,
                                        autoPan: true,
                                        maxHeight: 200,
                                        minWidth: 250,
                                        pane: "topPane"
                                    }).setContent(contentString));




                                    window[layername + '_markers'].addLayer(marker);
                                    // //
                                    for (var k = 0; k < type.length; k++) {


                                        if (type[k].type == feature.properties.type) {
                                            // window[sub_array[i]['type'].replace(' ', '_') + '_markers'].addLayer(marker);
                                            window[type[k].type.replace(' ', '_') + '_markers'].addLayer(marker);


                                        }
                                    }
                                    return marker;
                                },
                                onEachFeature: function (feature, layer) {

                                    for (let i = 0; i < type.length; i++) {
                                        ////////

                                        if (type[i]['type'] == feature.properties.type) {
                                            layer.addTo(window[type[i]['type'].replace(' ', '_')]);


                                        }
                                    }


                                    // var contentString = createPopup(feature,layername);
                                    // layer.bindPopup(L.popup({
                                    //   //closeOnClick: true,
                                    //   //closeButton: true,
                                    //   keepInView: true,
                                    //   autoPan: true,
                                    //   maxHeight: 200,
                                    //   minWidth: 250,
                                    // pane:"topPane"
                                    // }).setContent(contentString));
                                    ////////


                                }

                            });

                            // //
                            // //
                        }
                    });



                }


            });


            visible_layers_count = 0;
            filtered_layer_name = "";
            var count_names = 0;
            var count_names_total = [];

            function getLayersInsidePolygon(coords, visible_layers) {
                ////////
                $('#filtered_layer_list_container').html('');

                $('#filtered_header').html('');


                for (var i = 0; i < visible_layers.length; i++) {
                    //var layer_icon = "";
                    //  var filter3 = new L.Filter.Within('location', L.polygon([L.latLng(27.459539332717906,86.66015625000001),L.latLng(26.78484736105119,87.78076171875001),L.latLng(27.039556602163195,88.60473632812501)]), L.CRS.EPSG4326);
                    var filter3 = new L.Filter.Within('point', L.polygon([coords]), L.CRS.EPSG4326);
                    //var filter4 = new L.Filter.Within('location', L.polygon([L.latLng(27.68307, 85.4635),L.latLng(27.7213, 85.4914),L.latLng(27.72418, 85.44831)]), L.CRS.EPSG4326);
                    //filter3.toGml();

                    //filter1.toGml();
                    ////////
                    visible_layers[i].count = 0;
                    //////
                    layer_icon = visible_layers[i]['icon'];
                    window[visible_layers[i]['layerName'] + "_filteredLayers"] = new L.WFST({
                        url: visible_layers[i]['url'],
                        typeNS: visible_layers[i]["workspace"],
                        typeName: visible_layers[i]['layerName'],
                        crs: L.CRS.EPSG4326,
                        geometryField: 'point',
                        filter: filter3, //new L.Filter.BBox('ogr_geometry', map.getBounds(), L.CRS.EPSG4326),
                        style: {
                            color: 'blue',
                            weight: 2
                        },
                        layername: visible_layers[i]['layerName'],
                        // pane:"pointsPane",

                    },
                        new L.Format.GeoJSON({
                            crs: L.CRS.EPSG4326,
                            pointToLayer(geoJsonPoint, latlng) {

                                //////
                                // //////
                                if (filtered_layer_name != geoJsonPoint.id.split(".")[0] && filtered_layer_name != "") {
                                    count_names++;

                                }

                                var divicon = L.divIcon({
                                    html: '<div class="image-icon"></div>',
                                    // Specify a class name we can refer to in CSS.
                                    className: visible_layers[count_names]['icon'],
                                    // Set a markers width and height.
                                    //iconSize: [52, 52],
                                    iconAnchor: [4, 2]
                                });

                                var marker = L.marker(
                                    latlng, {
                                        icon: divicon,
                                        pane: "pointsPane"
                                    });






                                // var divicon = L.divIcon({
                                //     className: visible_layers[count_names]['icon']
                                //
                                // });
                                // var marker = L.marker(latlng,{icon:divicon});
                                //
                                //
                                //
                                visible_layers[count_names].count++;
                                ////////
                                filtered_layer_name = geoJsonPoint.id.split(".")[0];
                                return marker;


                            }
                        })

                    ).addTo(map).on('load', function (feature, layer) {
                        // ////
                        //
                        //
                        ////////
                        var filterhtml =
                            '<i class="ion ion-md-arrow-dropdown filtered-list-dropdown"></i><li data-toggle="collapse"  href="#filtered_layer_list' + visible_layers_count + '">' + visible_layers[visible_layers_count]["layerName"] + '  (' + visible_layers[visible_layers_count]["count"] + ')</li>' +
                            '<div id="filtered_layer_list' + visible_layers_count + '" class="panel-collapse collapse">' +
                            '<ul id= "filtered_layer_list_ul' + visible_layers_count + '" class="list-group filtered_layer_list_ul">' +

                            '</ul>' +
                            '</div>';














                        //  filterhtml += '<div id="'+visible_layers[visible_layers_count]['layerName']+'_filterlist" class="inner_wrapper" style="border: 1px solid #f3eeee; margin-top:5px;"><div class="leftSidebar-header" id="filtered_header'+visible_layers_count+'">'+
                        //
                        // '</div>'+
                        // '<div class="sidebar-widget">'+
                        //     '<ul class="list-content" id="filtered_layer_list'+visible_layers_count+'">'+
                        //
                        //     '</ul>'+
                        // '</div></div>';

                        $('#filtered_layer_list_container').append(filterhtml);
                        $.each(feature.target._layers, function (i) {
                            //  //////

                            // var divicon = L.divIcon({
                            //     className: visible_layers[visible_layers_count]['layerName']
                            //
                            // });
                            // var marker = L.marker(feature.target._layers[i].feature.geometry.coordinates,{icon:divicon});
                            // feature.target._layers[i].setIcon(marker);

                            //return marker;
                            var featurecount = 0;
                            for (var j = 0; j < visible_layers.length; j++) {
                                if (visible_layers[visible_layers_count]['layerName'] == feature.target._layers[i].feature.id.split('.')[0]) {
                                    // //
                                    featurecount = j;
                                }
                            }
                            ////
                            //$('#filtered_header'+visible_layers_count).html('<h4>'+feature.target._layers[i].feature.id.split('.')[0]/*+' ('+visible_layers[featurecount]['count']+')*/+'</h4>');


                            ////
                            ////

                            //if(visible_layers[visible_layers_count]['layerName']==feature.target._layers[i].feature.id.split('.')[0]){
                            ////
                            ////
                            var list_item = "<li class='list-group-item'><a class = 'filtered_list_items' data='" + JSON.stringify(feature.target._layers[i].feature.properties) + "' data-name='" + visible_layers[visible_layers_count]['layerName'] + "' center='" + JSON.stringify(feature.target._layers[i].feature.geometry.coordinates) + "' href='#' target=''>" + feature.target._layers[i].feature.properties.title + "</a></li>";
                            //layer);
                            //////
                            //////
                            $('#filtered_layer_list_ul' + visible_layers_count).append(list_item);
                            //}



                            var contentString = createPopup(feature.target._layers[i].feature, visible_layers[visible_layers_count]['layerName']);
                            ////////
                            feature.target._layers[i].on('click', function () {
                                //////
                            });
                            feature.target._layers[i].bindPopup(L.popup({
                                //closeOnClick: true,
                                //closeButton: true,
                                keepInView: true,
                                autoPan: true,
                                maxHeight: 200,
                                minWidth: 250,
                                pane: "topPane"
                            }).setContent(contentString));

                        });
                        $('.leftsidebarwrapper').css('display', 'block');
                        visible_layers_count++;




                        //map.fitBounds(window[visible_layers[i]['layerName']+"_filteredLayers"].getBounds());
                    });

                    if (map.hasLayer(window[layerName + '_markers'])) {
                        map.removeLayer(window[layerName + '_markers']);
                    } else if (map.hasLayer(window["filter_cluster"])) {
                        map.removeLayer(window["filter_cluster"]);
                    }

                    // map.removeLayer(window[visible_layers[i]['layerName']]);
                    $('#capacity-popup').hide(300);
                    $('.CheckBox').prop('checked', false);
                    $("." + visible_layers[i]['layerName'] + "_activeclass").removeClass("active");
                    $('#' + visible_layers[i]['layerName'] + '_legend').remove();





                }



            }




            $('#filtered_layer_list_container').on('click', '.filtered_list_items', function () {
                var properties = JSON.parse($(this).attr('data'));
                var name = $(this).attr('data-name');
                var center = JSON.parse($(this).attr('center'));
                var lat = center[1];
                var long = center[0];
                map.flyTo([lat, long], 18);
                var feature = {
                    "properties": properties
                }
                var contentString = createPopup(feature, name);
                var popup = L.popup()
                    .setLatLng([lat, long])
                    .setContent(contentString)
                    .openOn(map);

            });



            //draw start
            drawnItems = new L.FeatureGroup({
                pane: 'polygonsPane'
            });


            var drawControl = new L.Control.Draw({
                position: "topleft",
                draw: {

                    // disable toolbar item by setting it to false
                    polyline: false,
                    circle: false, // Turns off this drawing tool
                    rectangle: false,
                    marker: false,
                },
                edit: {
                    featureGroup: drawnItems
                }

            });

            map.addControl(drawControl);



            map.on('draw:created', function (e) {
                var type = e.layerType,
                    layer = e.layer;
                map.addLayer(drawnItems);
                drawnItems.addLayer(layer);
                drawnItems.setStyle({
                    fillColor: 'gray',
                    color: 'red',
                    fillOpacity: 0.1,
                    opacity: 1,
                    weight: 2
                });
                // layer.bindPopup("sadfdsa");

                layer.on('click', function () {
                    //  //////

                    setTimeout(function () {

                        if ($.isEmptyObject(drawnItems._layers)) {
                            //  //////
                            for (var i = 0; i < visible_layers.length; i++) {

                                if (map.hasLayer(window[visible_layers[i]['layerName'] + "_filteredLayers"])) {

                                    map.removeLayer(window[visible_layers[i]['layerName'] + "_filteredLayers"]);


                                }

                            }
                            visible_layers_count = 0;
                            visible_layers = [];
                            $('#filtered_layer_list').html('');
                            $('.leftsidebarwrapper').css('display', 'none');
                            $('.leaflet-draw').css('left', '5px');


                        }


                    }, 100);

                });


                $('.leaflet-draw').css('left', '266px');


                //  //////
                var coordinates = e.layer.editing.latlngs[0][0];
                getLayersInsidePolygon(coordinates, visible_layers)
                map.fitBounds(layer.getBounds());
            });
            //draw end

            visible_layers = [];
            resource_filtered_global = null;

            //resource layer map add
            $(".CheckBox").on('click', function () {
                ////////
                //removeAllLayers();
                //sub cat data in map
                if ($('#filtered_layer_list_container').css('display') == "none") {
                    $('.leaflet-draw').css('left', '5px');
                }


                $('.leaflet-draw').css('display', 'block');

                var geo_url = $(this).attr("data-url");

                var geo_workspace = $(this).attr("data-workspace");
                layerName = $(this).val();
                var subcat = $(this).attr("data-subcat");
                var total_sum = $(this).attr("data-count");
                var layer_icon = $(this).attr("data-icon");
                //////
                var filter_resources = $(this).attr("data-filter");
                var filter_resources_range = $(this).attr("data-range").replace(/_/g, "");
                var filter_range_label = $(this).attr("data-range").replace(/_/g, " ");

                // 
                // 
                subcat_array1 = eval("[" + subcat.split("[")[1].split("]")[0] + "]");
                ////
                subcat_array = [];
                for (var i = 0; i < subcat_array1.length; i++) {
                    //
                    subcat_array.push(subcat_array1[i]['type']);

                }
                // //

                // //

                //////


                if (map.hasLayer(window[layerName]) || map.hasLayer(window["filter_resource_marker_" + layerName]) || $('.' + layerName + '_parent').prop('checked') == false) {
                    //

                    map.removeLayer(window[layerName]);
                    map.removeLayer(window[layerName + '_markers']);
                    // map.removeLayer(window["filter_resource_marker_" + layerName]);
                    if (map.hasLayer(window[layerName + "_filteredLayers"])) {
                        map.removeLayer(window[layerName + "_filteredLayers"]);
                    }
                    if (map.hasLayer(window["filter_cluster"])) {
                        map.removeLayer(window["filter_cluster"]);
                    }

                    $('#' + layerName + '_filterlist').html('');

                    if ($('.CheckBox:checked').length == 0) {

                        $('.leaflet-draw').css('display', 'none');
                        map.removeLayer(drawnItems);
                        map.removeLayer(window["filter_resource_marker_" + layerName]);

                        if (map.hasLayer(window["filter_resource_" + layerName])) {

                            map.removeLayer(window["filter_resource_" + layerName]);

                        }
                        var ml = 0;
                        if (ml == 0) {
                            // map.removeLayer(window["filter_resource_marker_" + layerName]);
                            map.removeLayer(window[layerName + '_markers']);
                        }
                        drawnItems._layers = {};
                        visible_layers_count = 0;
                        for (var m = 0; m < visible_layers.length; m++) {

                            if (map.hasLayer(window[visible_layers[m]['layerName'] + "_filteredLayers"])) {

                                map.removeLayer(window[visible_layers[m]['layerName'] + "_filteredLayers"]);


                            }

                        }
                        visible_layers = [];
                        $('#filtered_layer_list').html('');
                        $('#filtered_layer_list_container').css('display', 'none');
                    }

                    $("." + layerName + "_activeclass").removeClass("active");
                    $('#' + layerName + '_legend').remove();
                    ////
                    for (var i = 0; i < visible_layers.length; i++) {
                        if (visible_layers[i].layerName == layerName) {
                            ////
                            visible_layers.splice(i, 1);
                        }
                    }

                    // //////
                    if ($('.' + layerName + '_parent').prop('checked') == false) {
                        ////////
                        $('.' + layerName + '_child').prop('checked', false);
                        $('#capacity-popup').css('display', 'none')
                        //$('.'+layerName+'_parent').trigger('click');

                    } else {
                        ////////
                        $('.' + layerName + '_child').prop('checked', true);
                        //$('#capacity-popup').find('.'+layerName+'_child').prop('checked',true);
                        // //////
                        //$('.'+layerName+'_parent').trigger('click');

                    }

                } else {
                    // //
                    for (var i = 0; i < subcat_array1.length; i++) {
                        ////
                        // map.addLayer(window[subcat_array1[i]['type'].replace(' ', '_')+'_markers']);




                    }
                    if (map.hasLayer(window["filter_resource_marker_" + layerName])) {
                        map.removeLayer(window["filter_resource_marker_" + layerName]);
                    }


                    if ($('.' + layerName + '_parent').prop('checked') == false) {
                        $('#capacity-popup').css('display', 'none');
                        //
                        map.removeLayer(window["filter_resource_" + layerName]);
                        map.removeLayer(window["filter_resource_marker_" + layerName]);
                        var ml = 0;
                        if (ml == 0) {
                            map.removeLayer(window["filter_resource_marker_" + layerName]);
                            map.removeLayer(window["filter_resource_" + layerName]);
                        }
                    } else {
                        //
                        // map.addLayer(window[layerName]);
                        // map.addLayer(window[layerName + '_markers']);

                        visible_layers.push({
                            "layerName": layerName,
                            "url": geo_url,
                            "workspace": geo_workspace,
                            "icon": layer_icon
                        });

                    }




                    //$("."+layerName+"_activeclass").addClass("active");
                    let url = geo_url + '?REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&WIDTH=20&HEIGHT=10&&crossOrigin=Anonymous&LAYER=' + layerName + '&';
                    //  //////
                    //info._div.innerHTML = info._div.innerHTML+'<div id="'+layerName+'_legend" style="background:white; padding:5px;"><h6>'+layerName+'</h6><img  src="'+url+'"/></div>';
                    ////////




                    response = window[layerName].toGeoJSON();


                    CreateChartData(response, subcat_array, null, 'both', total_sum, layerName, filter_resources, filter_resources_range, layer_icon, filter_range_label);

                    filter_check(response, null, null, null, null, layer_icon);

                    //  //////
                    if ($('.' + layerName + '_parent').prop('checked') == false) {
                        //  //////
                        $('.' + layerName + '_child').prop('checked', false);
                        //$('.'+layerName+'_parent').trigger('click');

                    } else {
                        //  //////
                        $('.' + layerName + '_child').prop('checked', true);
                        //$('#capacity-popup').find('.'+layerName+'_child').prop('checked',true);
                        ////////
                        //$('.'+layerName+'_parent').trigger('click');

                    }


                }



            });

            // exposure parent  radio

            $('.exoposure_data_pop').on('click', function () {

                var id = $(this).attr('id');
                // var this_id = ($(this).attr('id'));
                // $('.admin_bound[data-parent="' + this_id + '"]').parent().toggleClass('custom-check ');

                $('.exposure_geo[data-parent="' + id + '"]').parent().attr('class', 'custom-control custom-radio');
                var data_pop = $(this).attr('data-pop');

                if ($(this).prop("checked") == 'true') {

                }
                else {
                    // map.removeLayer(window["layername"]);
                    removeAllLayers();
                    map.fitBounds(province_bbox);
                }
                // if($(this).prop)

                var current_layer = $(this).attr('data-currentLayer');
                if (current_layer != "") { //child layer off from parent
                    map.removeLayer(window[current_layer]);
                    // map.flyTo([28.410728397237914, 84.4024658203125], 7);
                    map.fitBounds(province_bbox);
                    $('.legend-list').html(" ");

                }

                var url = base_url + "/risk_profile/exposure?title=" + data_pop;
                url = url.replace(" ", "%20")
                //


                $.ajax({
                    url: url,
                    //data:{"layer_icon":layer_icon, "data":data,"i":i},

                    success: function (response) {
                        ////

                        for (var k = 0; k < response.length; k++) {
                            //
                            var expo_pop_html = "";
                            var expo_layer = response[k].ExposureLayer;
                            //
                            for (var l = 0; l < expo_layer.length; l++) {
                                //
                                if (data_pop == 'Drone Imageries') {
                                    $("#exposure_drone_pop").html("");
                                    //
                                    expo_pop_html += '<li class="active opacityParent">';
                                    expo_pop_html += '<div class="custom-control custom-radio">' +
                                        '<i class="ion ion-md-information-circle" style="float:right;" data-toggle="popover" data-trigger="hover" data-placement="left" data-content="Drone Images"></i>' +
                                        '<span class="ion ion-md-contrast" style="float:right; border:none;"></span>' +
                                        '<input type="radio" class="custom-control-input exposure_geo" data-workspace="' + expo_layer[l].workspace + '"' +
                                        'data-parent="OSM" data-layername="' + expo_layer[l].layername + '"' +
                                        'data-url="https://apps.naxa.com.np/geoserver/wms" data-center="' + expo_layer[l].center + '"' +
                                        'id="test_1' + [l] + '" name="test1" value="customEx">' +
                                        '<label class="custom-control-label" for="test_1' + [l] + '">' + expo_layer[l].title + '</label></div>' +
                                        ' <div class="range-box">' +
                                        '<input type="range" min="0" max="100" class="center" data-name-trans="bancharedanda">' +
                                        '</div>' +
                                        '</li>';

                                    $('#exposure_drone_pop').html(expo_pop_html);
                                }
                                // else if (data_pop == 'Infrastructures') {
                                //   $("#exposure_infra_pop").html("");
                                //   expo_pop_html += '<li class="active">';
                                //   expo_pop_html += '<div class="custom-control custom-checkbox">' +
                                //     '<input type="checkbox" class="custom-control-input exposure_geo infan" data-workspace="' + expo_layer[l].workspace + '"' +
                                //     'data-parent="Land" data-layername="' + expo_layer[l].layername + '"' +
                                //     'data-url="https://apps.naxa.com.np/geoserver/wms" data-center="' + expo_layer[l].center + '"' +
                                //     'id="build_1' + [l] + '" name="build_1" value="customEx">' +
                                //     '<label class="custom-control-label" for="build_1' + [l] + '">' + expo_layer[l].title + '</label></div>' +
                                //     ' <div class="range-box">' +
                                //     '<input type="range" min="0" max="100" class="center" data-name-trans="bancharedanda">' +
                                //     '</div>' +
                                //     '</li>';

                                //   $('#exposure_infra_pop').html(expo_pop_html);
                                //   //
                                // }
                            }

                        }
                    }

                });
            });
            //exposure end parent


            //hazard creating html on click
            $(".hazard_list").on('click', function () {
                id = $(this).attr('id');
                var current_layer = $(this).attr('data-currentLayer');
                //////

                if (current_layer != "") { //child layer off from parent
                    //
                    map.removeLayer(window[current_layer]);
                    // map.flyTo([28.410728397237914, 84.4024658203125], 7);
                    map.fitBounds(province_bbox);
                    $('.legend-list').html(" ");

                }

                $('#hazard_popup_html').html(" ");
                ////////
                var url = base_url + "/risk_profile/hazard?title=" + id;
                ////
                $.ajax({
                    url: url,
                    //data:{"layer_icon":layer_icon, "data":data,"i":i},

                    success: function (response) {
                        ////

                        for (var k = 0; k < response.length; k++) {

                            var hazard_pop_html = "";
                            hazard_pop_html += '<div class="hazard-title">' +
                                '<h3><span class="humanitarian-icon-Flood"></span>' + response[k].title + '</h3>' +
                                '<button type="button" class="button hazardDetails-close">' +
                                '<i class=" ion ion-md-close-circle-outline"></i>' +
                                '</div>' +
                                '<div class="hazard-content">' +

                                '<div class="hazard-acc">' +
                                '<div id="accordion">';
                            var i = 0;
                            var hazardlayer = response[k].HazardLayer;
                            //
                            // $.each( response.data, function( key, value ) {
                            for (var l = 0; l < hazardlayer.length; l++) {
                                var aria_expand = 'false';
                                var show = '';
                                if (i == 0) {
                                    aria_expand = 'true';
                                    show = 'show';
                                }
                                hazard_pop_html += '<div class="card opacityParent">';
                                hazard_pop_html += '<div class="card-header" id="' + hazardlayer[l].title + i + '">' +
                                    '<h5>' +
                                    '<a class="collapsed updown" role="button" data-toggle="collapse" href="#landslide_col_' + i + '" aria-expanded="' + aria_expand + '" aria-controls="landslide_col_' + i + '">' + hazardlayer[l].title.replace(/_/g, " ") + "</a>" +
                                    '<div class="icon-list">' +
                                    '<span class="ion ion-md-information-circle" data-toggle="popover" data-trigger="hover" data-placement="left" data-content="' + hazardlayer[l].about + '"></span>' +
                                    '<a href="http://bipad.togglecorp.com"><span class="ion ion-md-albums"></span></a>' +
                                    '<span class="ion ion-md-contrast"></span>' +
                                    '</div>' +

                                    '</h5>' +

                                    '</div>';
                                // //////
                                // //////
                                //var dataaa=response.data[key];
                                var hazardsublayer = hazardlayer[l].HazardSubLayer;

                                hazard_pop_html += '<div id="landslide_col_' + i + '" class="collapse ' + show + '" data-parent="#accordion" aria-labelledby="' + hazardlayer[l].title + i + '">' +
                                    '<div class="card-body">' +
                                    '<div class="range-box">' +
                                    '<input type="range" min="0" max="100" value="100" class="center" data-name-trans="' + hazardlayer[l].title + '">' +
                                    '</div>' +
                                    '<ul class="hazardDetail-list">';

                                var j = 0;

                                // $.each(dataaa, function( key, value ) {
                                for (var m = 0; m < hazardsublayer.length; m++) {
                                    // //////
                                    hazard_pop_html += '<li>' +
                                        '<div class="custom-control custom-radio">' +
                                        '  <input type="radio" class="custom-control-input hazard_geo" id="' + hazardsublayer[m].title + i + j + '" data-layername="' + hazardsublayer[m].layername + '" data-workspace="' + hazardsublayer[m].geoserverWorkspace + '" data-center="' + hazardsublayer[m].center + '" name="year17" value="customEx">' +
                                        '<label class="custom-control-label" for="' + hazardsublayer[m].title + i + j + '">' + hazardsublayer[m].title + '</label>' +
                                        '</div>' +
                                        '</li>';
                                    j++;
                                }; //end of sublayer

                                hazard_pop_html += '</ul>';
                                hazard_pop_html += '</div>';
                                hazard_pop_html += '</div>';
                                hazard_pop_html += '</div>';
                                i++;
                            } //end of layer

                            hazard_pop_html += '</div>';
                            hazard_pop_html += '</div>';
                            hazard_pop_html += '</div>';

                            // //////
                            $('#hazard_popup_html').html(hazard_pop_html);
                            $('[data-toggle="popover"]').popover();

                        }
                    } //success end

                });

                // $('[data-toggle="popover"]').popover();

            });



            //end hazard

            // end resource

            function createCluster(data, layer_icon1, layername) {
                map.removeLayer(window[layername + "_markers"]);
                // map.removeLayer(window["filter_cluster"]);
                if (map.hasLayer(window["filter_cluster"])) {
                    map.removeLayer(window["filter_cluster"]);
                }
                window["filter_cluster"] = L.markerClusterGroup({
                    disableClusteringAtZoom: 12,
                    clusterPane: 'pointsPane',
                });
                filter_cluster_layer = new L.geoJson(data, {
                    // pane:"polygonsPane",
                    pointToLayer: function (feature, Latlng) {

                        // var divicon = L.divIcon({
                        //     className: layer_icon1
                        //
                        // });

                        ////
                        var divicon = L.divIcon({
                            html: '<div class="image-icon"></div>',
                            // Specify a class name we can refer to in CSS.
                            className: layer_icon1,
                            // Set a markers width and height.
                            //iconSize: [52, 52],
                            iconAnchor: [4, 2],
                            // pane:"polygonsPane"
                        });

                        var marker = L.marker(
                            Latlng, {
                                icon: divicon,
                                pane: "markerPane"
                            });

                        var contentString = createPopup(feature, layername);
                        marker.bindPopup(L.popup({
                            //closeOnClick: true,
                            //closeButton: true,
                            keepInView: true,
                            autoPan: true,
                            maxHeight: 200,
                            minWidth: 250,
                            pane: "topPane"
                        }).setContent(contentString));




                        window["filter_cluster"].addLayer(marker);


                        return marker;
                    },
                    onEachFeature: function (feature, layer) {

                    }

                });

                map.addLayer(window["filter_cluster"]);


            }



            // $("#capacity-popup").on('change', '.filter_resource_btn', function () {
            //     

            //     var layerName = $(this).attr('name');
            //     var layer_icon = $(this).attr('data-icon');
            //     var total_sum = $(this).attr('data-sum');
            //     
            //     
            //     

            //     var features_data_radio = [];
            //     var sub_layer_name = [];

            //     // var layer_data = jQuery.extend(true, {}, layer_data1);
            //     // //////
            //     var checkedList = [];
            //     $.each($("input[class='filter_resource_btn']:checked"), function () {

            //         checkedList.push($(this).val());
            //     });
            //     

            // });


            //sub category resources
            // $('#capacity-popup').on('click', '.sub_cat_ex', function () {

            //     all_layerName = $(this).val();
            //     ////
            //     sub_layerName = $(this).attr('data-sub');
            //     type_id = all_layerName + '_id';
            //     subcat_array1 = $('#' + type_id).attr('data-subcat');
            //     layer_icon = $(this).attr('data-icon');

            //     ////////
            //     ////////
            //     //if($(this).find('::checked').length > 0){
            //     if ($('.' + layerName + '_child:checked').length > 0) {
            //         //  //////
            //         $('.' + layerName + '_parent').prop('checked', true);
            //         //$('.'+layerName+'_parent').trigger('click');
            //         //  //////

            //     } else {
            //         ////////
            //         $('.' + layerName + '_parent').prop('checked', false);
            //         //$('.'+layerName+'_parent').trigger('click');
            //         //  //////


            //     }

            //     ////
            //     // //
            //     var all_markercluster = window[sub_layerName + '_markers']._needsClustering;

            //     // if (map.hasLayer(window[sub_layerName+'_markers']) && $(this).prop('checked') == false) {

            //     //   map.removeLayer(window[sub_layerName+'_markers']);
            //     // } else {

            //     //   ////////
            //     //   // pharmacy.addTo(map);
            //     //   // map.addLayer(window[sub_layerName+'_markers']);

            //     // }


            //     var features_data = [];
            //     $.each($('.sub_cat_ex:checked'), function () {

            //         var name_sub = $(this).attr('data-sub');
            //         // sub_layer_name.push($(this).attr('data-sub'));
            //         //  //////
            //         var layersdata = window[name_sub]._layers
            //         ////////
            //         $.each(layersdata, function (feature) {

            //             //  //
            //             features_data.push(layersdata[feature].feature);

            //         });

            //     });

            //     var layer_data1 = {
            //         "type": "FeatureCollection",
            //         "features": features_data

            //     };
            //     // if()
            //     createCluster(layer_data1, layer_icon, all_layerName);
            //     //


            // });

            //end sub category resource

            //dragTapSlider.noUiSlider.on('slide.one', function() {

            function filtermap(layer_data, checkedList, sub_layer_name, total_sum, layerName, layer_icon) {

                if (map.hasLayer(window["filter_resource_marker_" + layerName])) {
                    map.removeLayer(window["filter_resource_marker_" + layerName]);
                }
                window["filter_resource_marker_" + layerName] = null;

                window["filter_resource_marker_" + layerName] = L.markerClusterGroup({
                    disableClusteringAtZoom: 12,
                    clusterPane: 'pointsPane'
                });

                ////////
                window["filter_resource_" + layerName] = new L.geoJson(layer_data, {

                    pointToLayer: function (feature, Latlng) {

                        var divicon = L.divIcon({
                            className: 'humanitarian-icon-Hospital'

                        });
                        var marker = L.marker(Latlng, {
                            icon: divicon
                        });


                        window["filter_resource_marker_" + layerName].addLayer(marker);
                        return marker;

                        // return marker;
                    },
                    onEachFeature: function (feature, layer) {


                        var contentString = createPopup(feature, layerName);
                        layer.bindPopup(L.popup({
                            //closeOnClick: true,
                            //closeButton: true,
                            keepInView: true,
                            autoPan: true,
                            maxHeight: 200,
                            minWidth: 250,
                            pane: "topPane"
                        }).setContent(contentString));

                    }

                });
                // map.removeLayer(window[layerName]);
                // map.removeLayer(window[layerName + '_markers']);
                window["filter_resource_marker_" + layerName].addTo(map);
                // map.removeLayer(window["filter_resource_marker" + layerName]);

                if (checkedList.length == 0) {
                    data_geo = window[layerName].toGeoJSON()
                    //map.addLayer(window[layerName]);
                    if (map.hasLayer(window["filter_resource_marker_" + layerName])) {

                        // //
                        map.removeLayer(window["filter_resource_marker_" + layerName]);
                        map.removeLayer(window["filter_resource_" + layerName]);


                        map.addLayer(window["filter_resource_" + layerName]);
                        // map.addLayer(window["filter_resource_marker_" + layerName]);
                        // map.addLayer(window[layerName + '_markers']);
                    }
                    CreateChartData(data_geo, sub_layer_name, 'charttype', 'subcategory', total_sum, layerName, [], layer_icon, filter_range_label)
                } else {

                    map.removeLayer(window[layerName]);
                    CreateChartData(layer_data, sub_layer_name, 'charttype', 'subcategory', total_sum, layerName, [], layer_icon, filter_range_label)

                }


            }


            //resources filter

            // $("#capacity-popup").on('change', '.filter_resource_btn', function () {

            //     ////////
            //     var layerName = $(this).attr('name');
            //     var layer_icon = $(this).attr('data-icon');
            //     var total_sum = $(this).attr('data-sum');

            //     ////////
            //     ////////
            //     // //////

            //     var features_data = [];
            //     var sub_layer_name = [];

            //     // if (map.hasLayer(window["filter_resource_" + layerName])) {

            //     //   ////////


            //     //   map.removeLayer(window["filter_resource_" + layerName]);

            //     // }
            //     $.each($('.sub_cat_ex:checked'), function () {
            //         if (map.hasLayer(window["filter_resource_Health"])) {
            //             map.removeLayer(window["filter_resource_Health"]);
            //         }
            //         if (map.hasLayer(window["Health_markers"])) {
            //             map.removeLayer(window["Health_markers"]);
            //         }
            //         var name_sub = $(this).attr('data-sub');

            //         sub_layer_name.push($(this).attr('data-sub'));
            //         //  //////

            //         var layersdata = window[name_sub]._layers
            //         $.each(layersdata, function (feature) {

            //             ////////
            //             features_data.push(layersdata[feature].feature);

            //         });

            //     });

            //     var layer_data1 = {
            //         "type": "FeatureCollection",
            //         "features": features_data

            //     };


            //     ////////

            //     //layer_data1=window[layerName].toGeoJSON();
            //     // //////
            //     var layer_data = jQuery.extend(true, {}, layer_data1);
            //     // //////
            //     var checkedList = [];
            //     $.each($("input[class='filter_resource_btn']:checked"), function () {

            //         checkedList.push($(this).val());
            //     });
            //     
            //     if (checkedList == "") {
            //         
            //         var ml = 0;
            //         if (ml == 0) {
            //             map.removeLayer(window["filter_resource_marker_" + layerName]);
            //             map.addLayer(window[layerName + '_markers']);

            //         }

            //     }
            //     if (checkedList != "") {
            //         // map.removeLayer(window['filter_resource_' + layerName]);
            //         map.removeLayer(window[layerName + '_markers']);
            //         if (map.hasLayer(window[layerName])) {
            //             map.removeLayer(window[layerName]);
            //         }

            //     }
            //     // //

            //     // //
            //     // //
            //     // //
            //     // checkedList[i].toLowerCase();

            //     for (var k = layer_data.features.length - 1; k >= 0; k--) {
            //         var delete_count = 0;
            //         for (var i = 0; i < checkedList.length; i++) {
            //             // //
            //             // //
            //             // //
            //             // //
            //             var filteropt = checkedList[i].toLowerCase();
            //             //
            //             // //
            //             //
            //             // //
            //             // //

            //             if (layer_data.features[k].properties[filteropt] == true && layer_data.features[k].properties[filteropt] != "") {
            //                 // if (layer_data.features[k].properties[checkedList[i].trim()].trim().toUpperCase() == "YES" && layer_data.features[k].properties[checkedList[i]].trim() != "") {
            //                 ////////
            //                 ////////
            //                 delete_count++;
            //                 //
            //                 //

            //             }


            //         }
            //         ////////
            //         if (delete_count == 0) {
            //             ////////
            //             ////////
            //             ////////
            //             layer_data.features.splice(k, 1);
            //             //
            //         }


            //     }
            //     if (map.hasLayer(window["filter_resource_" + layerName])) {
            //         map.removeLayer(window["filter_resource_" + layerName]);
            //     }
            //     filtermap(layer_data, checkedList, sub_layer_name, total_sum, layerName, layer_icon);

            //     if (checkedList == []) {
            //         map.removeLayer(window["filter_resource_marker_" + layerName]);
            //         map.removeLayer(window["filter_resource_" + layerName]);
            //     }
            //     // //////
            //     ////////
            //     //////

            //     //////


            //     //////
            //     //////


            //     // CreateChartData(geojson,subcat,charttype,level,total_sum,layerName,filter_resources,layer_icon)





            //     // CreateChartData(layer_data,checkedList,'bar','filter');


            // });





            //resource filter end


            //loading adminstrative boundary accordin to need

            $('.admin_bound').on('click', function () {
                //////
                var admin_layer = $(this).attr('data-admin');
                //////

                if (admin_layer == 'municipality') {
                    // $('.legend-list').html('');
                    map.addLayer(window[admin_layer]);
                    labelcount = 0;
                    var zoom = map.getZoom();
                    if (zoom > 11) {
                        vt_label_municipality.addTo(map);
                    }




                    map.removeLayer(window['district']);
                } else {
                    map.addLayer(window[admin_layer]);
                    map.removeLayer(eval('municipality'));
                    labelcount = 0;
                    if (zoom > 8) {
                        vt_label_district.addTo(map);
                    }
                }


            });


            $("#capacity-popup").change('.amount', function () {
                //////


            });


            $(".trans_constrast").on('change', '.center', function () {
                //////
                //////
                var val = ($(this).val()) / 100;
                var name = $(this).attr('data-name-trans');
                window[name].setOpacity(val);
                // if(name=="Flood"){
                //   hazard_layers.setOpacity(val);
                // }else if(name=="drone"){
                //   exposure_layers.setOpacity(val);
                // }else{
                //   earthquake_risk.setOpacity(val);
                // }

            })

            //end



            //chart start--
            function createChartCompare(dataset, name1, id) {

                //
                var name = name1.split(" ")[0];
                $('#chart').append('<div class = "chartWrapper" id=' + id + ' ><div style="margin-bottom:10px;"><h7 class="chart_header">' + name + '</h7></div><div id="chartBody_' + name + '"></div></div>');
                // define data
                // var dataset = [
                //     {label: "Assamese", count: 13},
                //     {label: "Bengali", count: 83},
                //     {label: "Bodo", count: 1.4},
                //     {label: "Dogri", count: 2.3},
                //     {label: "Gujarati", count: 46},
                //     {label: "Hindi", count: 300},
                //     {label: "Kannada", count: 38},
                //     {label: "Kashmiri", count: 5.5},
                //     {label: "Konkani", count: 5},
                //     {label: "Maithili", count: 20},
                //     {label: "Malayalam", count: 33},
                //     {label: "Manipuri", count: 1.5},
                //     {label: "Marathi", count: 72},
                //     {label: "Nepali", count: 2.9},
                //     {label: "Oriya", count: 33},
                //     {label: "Punjabi", count: 29},
                //     {label: "Sanskrit", count: 0.01},
                //     {label: "Santhali", count: 6.5},
                //     {label: "Sindhi", count: 2.5},
                //     {label: "Tamil", count: 61},
                //     {label: "Telugu", count: 74},
                //     {label: "Urdu", count: 52}
                //   ];

                // chart dimensions
                var width = 200;
                var height = 120;

                // a circle chart needs a radius
                var radius = Math.min(width, height) / 2;

                // legend dimensions
                var legendRectSize = 10; // defines the size of the colored squares in legend
                var legendSpacing = 2; // defines spacing between squares

                // define color scale
                var color = d3.scaleOrdinal(d3.schemeCategory20c);
                // more color scales: https://bl.ocks.org/pstuffa/3393ff2711a53975040077b7453781a9



                //
                var svg = d3.select('#chartBody_' + name) // select element in the DOM with id 'chart'
                    .append('svg') // append an svg element to the element we've selected
                    .attr('width', width) // set the width of the svg element we just added
                    .attr('height', height) // set the height of the svg element we just added
                    .append('g') // append 'g' element to the svg element
                    .attr('transform', 'translate(' + (width / 3) + ',' + (height / 2) + ')'); // our reference is now to the 'g' element. centerting the 'g' element to the svg element

                var arc = d3.arc()
                    .innerRadius(30) // none for pie chart
                    .outerRadius(radius); // size of overall chart

                var pie = d3.pie() // start and end angles of the segments
                    .value(function (d) {
                        return d.count;
                    }) // how to extract the numerical data from each entry in our dataset
                    .sort(null); // by default, data sorts in oescending value. this will mess with our animation so we set it to null

                // define tooltip
                var tooltip = d3.select('#chartBody_' + name) // select element in the DOM with id 'chart'
                    .append('div') // append a div element to the element we've selected
                    .attr('class', 'tooltip_chart'); // add class 'tooltip' on the divs we just selected

                tooltip.append('div') // add divs to the tooltip defined above
                    .attr('class', 'label'); // add class 'label' on the selection

                tooltip.append('div') // add divs to the tooltip defined above
                    .attr('class', 'count'); // add class 'count' on the selection

                tooltip.append('div') // add divs to the tooltip defined above
                    .attr('class', 'percent'); // add class 'percent' on the selection

                // Confused? see below:

                // <div id="chart">
                //   <div class="tooltip">
                //     <div class="label">
                //     </div>
                //     <div class="count">
                //     </div>
                //     <div class="percent">
                //     </div>
                //   </div>
                // </div>


                //
                dataset.forEach(function (d) {
                    d.count = +d.count; // calculate count as we iterate through the data
                    d.enabled = true; // add enabled property to track which entries are checked
                });

                // creating the chart
                var path = svg.selectAll('path') // select all path elements inside the svg. specifically the 'g' element. they don't exist yet but they will be created below
                    .data(pie(dataset)) //associate dataset wit he path elements we're about to create. must pass through the pie function. it magically knows how to extract values and bakes it into the pie
                    .enter() //creates placeholder nodes for each of the values
                    .append('path') // replace placeholders with path elements
                    .attr('d', arc) // define d attribute with arc function above
                    .attr('fill', function (d) {
                        return color(d.data.label);
                    }) // use color scale to define fill of each label in dataset
                    .each(function (d) {
                        this._current - d;
                    }); // creates a smooth animation for each track

                // mouse event handlers are attached to path so they need to come after its definition
                // path.on('mouseover', function(d) {  // when mouse enters div
                //  var total = d3.sum(dataset.map(function(d) { // calculate the total number of tickets in the dataset
                //   return (d.enabled) ? d.count : 0; // checking to see if the entry is enabled. if it isn't, we return 0 and cause other percentages to increase
                //   }));
                //  var percent = Math.round(1000 * d.data.count / total) / 10; // calculate percent
                //  tooltip.select('.label').html(d.data.label); // set current label
                //  tooltip.select('.count').html(d.data.count); // set current count
                //  tooltip.select('.percent').html(percent + '%'); // set percent calculated above
                //  tooltip.style('display', 'block'); // set display
                // });
                //
                // path.on('mouseout', function() { // when mouse leaves div
                //   tooltip.style('display', 'none'); // hide tooltip for that element
                //  });
                //
                // path.on('mousemove', function(d) { // when mouse moves
                //   //////
                //   tooltip.style('top', (d3.event.layerY + 0 ) + 'px') // always 10px below the cursor
                //     .style('left', (d3.event.layerX + 0) + 'px'); // always 10px to the right of the mouse
                //   });

                // path.on("mouseover", function (d) {
                //
                //             tooltip.html(d)
                //             .style("left", d3.select(this).attr("cx") + "px")
                //             .style("top", d3.select(this).attr("cy") + "px");
                //           })
                //               .on("mouseout", function () {
                //               // Hide the tooltip
                //               d3.select("#tooltip")
                //                   .style("opacity", 0);;
                //           });


                // define legend
                var legend = svg.selectAll('.legend') // selecting elements with class 'legend'
                    .data(color.domain()) // refers to an array of labels from our dataset
                    .enter() // creates placeholder
                    .append('g') // replace placeholders with g elements
                    .attr('class', 'legend') // each g is given a legend class
                    .attr('transform', function (d, i) {
                        var height = legendRectSize + legendSpacing; // height of element is the height of the colored square plus the spacing
                        var offset = height * color.domain().length / 3; // vertical offset of the entire legend = height of a single element & half the total number of elements
                        var horz = 7 * legendRectSize; // the legend is shifted to the left to make room for the text
                        var vert = i * height - offset - 13; // the top of the element is hifted up or down from the center using the offset defiend earlier and the index of the current element 'i'
                        return 'translate(' + horz + ',' + vert + ')'; //return translation
                    });

                // adding colored squares to legend
                legend.append('rect') // append rectangle squares to legend
                    .attr('width', legendRectSize) // width of rect size is defined above
                    .attr('height', legendRectSize) // height of rect size is defined above
                    .style('fill', color) // each fill is passed a color
                    .style('stroke', color) // each stroke is passed a color
                    .on('click', function (label) {
                        var rect = d3.select(this); // this refers to the colored squared just clicked
                        var enabled = true; // set enabled true to default
                        var totalEnabled = d3.sum(dataset.map(function (d) { // can't disable all options
                            return (d.enabled) ? 1 : 0; // return 1 for each enabled entry. and summing it up
                        }));

                        if (rect.attr('class') === 'disabled') { // if class is disabled
                            rect.attr('class', ''); // remove class disabled
                        } else { // else
                            if (totalEnabled < 2) return; // if less than two labels are flagged, exit
                            rect.attr('class', 'disabled'); // otherwise flag the square disabled
                            enabled = false; // set enabled to false
                        }

                        pie.value(function (d) {
                            if (d.label === label) d.enabled = enabled; // if entry label matches legend label
                            return (d.enabled) ? d.count : 0; // update enabled property and return count or 0 based on the entry's status
                        });

                        path = path.data(pie(dataset)); // update pie with new data

                        path.transition() // transition of redrawn pie
                            .duration(750) //
                            .attrTween('d', function (d) { // 'd' specifies the d attribute that we'll be animating
                                var interpolate = d3.interpolate(this._current, d); // this = current path element
                                this._current = interpolate(0); // interpolate between current value and the new value of 'd'
                                return function (t) {
                                    return arc(interpolate(t));
                                };
                            });
                    });

                // adding text to legend
                legend.append('text')
                    .attr('x', legendRectSize + legendSpacing)
                    .attr('y', legendRectSize - legendSpacing)
                    // .attr('width', legendRectSize) // width of rect size is defined above
                    .style('font-size', '8px') // height of rect size is defined above
                    .text(function (d) {
                        return d;
                    }); // return label

            }
            //chart end


            var prov_li = "";
            var dist_li = "";
            var mun_li = "";
            $.get("https://bipad.nepware.com/api/v1/province/?format=json&&fields=id,title", function (dataP, statusP) {
                //////
                //////
                $.each(dataP.results, function (keyP, valueP) {
                    prov_li += '<li class="federal" id="' + (dataP.results[keyP].title).replace(/ /g, "_") + '" data-fed="district" data-id="' + dataP.results[keyP].id + '" data-request="province">' + dataP.results[keyP].title + '</li>';
                });
                $('#federal_boundary').html(prov_li);

                $.get("https://bipad.nepware.com/api/v1/district/?format=json&&search=&&fields=id,title,province", function (dataDistrict, statusDistrict) {
                    //////
                    $.each(dataP.results, function (keyP, valueP) {
                        $.each(dataDistrict.results, function (keyD, valueD) {
                            if (dataP.results[keyP].id == dataDistrict.results[keyD].province) {
                                dist_li += '<li class="federal" id="' + (dataDistrict.results[keyD].title).replace(/ /g, "_") + '" data-fed="municipality" data-id="' + dataDistrict.results[keyD].id + '" data-request="district">' + dataDistrict.results[keyD].title + ', ' + dataP.results[keyP].title + '</li>';

                            }
                        });
                    });
                    $('#federal_boundary').append(dist_li);

                    $.get("https://bipad.nepware.com/api/v1/municipality/?format=json&search=&&fields=id,title,district", function (dataMun, statusMun) {
                        $.each(dataP.results, function (keyP, valueP) {
                            $.each(dataDistrict.results, function (keyD, valueD) {
                                $.each(dataMun.results, function (keyM, valueM) {
                                    if (dataDistrict.results[keyD].id == dataMun.results[keyM].district) {
                                        if (dataP.results[keyP].id == dataDistrict.results[keyD].province) {
                                            mun_li += '<li class="federal" id="' + (dataMun.results[keyM].title).replace(/ /g, "_") + '"  data-id="' + dataMun.results[keyM].id + '" data-request="municipality" data-fed="ward">' + dataMun.results[keyM].title + ', ' + dataDistrict.results[keyD].title + ', ' + dataP.results[keyP].title + '</li>';
                                        }
                                    }
                                });
                            });
                        });
                        $('#federal_boundary').append(mun_li);
                    });



                });
            });



            // creating  filter
            // var prov_li="";
            // var dist_li="";
            // var mun_li="";
            // $.ajax({
            //   url: 'https://bipad.nepware.com/api/v1/province/?format=json&&fields=id,title',
            //   success: function(data) {
            //       ////
            //
            //       var  result=data.results;
            //
            //         for(var i=0;i<result.length;i++){
            //
            //          prov_li+='<li class="federal" id="'+result[i].title+'" data-fed="province">'+result[i].title+'</li>';
            //         }
            //
            //           ////
            //           $('#federal_boundary').html(prov_li);
            //
            //         }
            //                        // async:false,
            //
            //   });
            //
            //
            //
            //   $.ajax({
            //     url: 'https://bipad.nepware.com/api/v1/district/?format=json&limit=20&search=&&fields=id,title',
            //     success: function(data) {
            //       //////
            //       var  result=data.results;
            //
            //         for(var i=0;i<result.length;i++){
            //
            //          dist_li+='<li class="federal" id="'+result[i].title+'" data-fed="district">'+result[i].title+'</li>';
            //         }
            //
            //
            //           $('#federal_boundary').append(dist_li);
            //
            //           }
            //                          // async:false,
            //
            //     });
            //


            // $.ajax({
            //   url: 'https://bipad.nepware.com/api/v1/municipality/?format=json&limit=20&search=&&fields=id,title',
            //   success: function(data) {
            //     //////
            //     var  result=data.results;
            //
            //       for(var i=0;i<result.length;i++){
            //
            //        mun_li+='<li class="federal" id="'+result[i].title+'" data-fed="municipality">'+result[i].title+'</li>';
            //       }
            //
            //
            //         $('#federal_boundary').append(mun_li);
            //
            //         }
            //                        // async:false,
            //
            //   });


            federal_boundary = null;
            federal_maskboundary = null;
            Mask = null;


            $('#federal_boundary').on('click', '.federal', function () {
                $('.loader').css('display', 'block');
                $('.filter-listing').hide();
                // ////
                // ////



                //map.removeLayer(province);
                //map.removeLayer(district);
                //map.removeLayer(municipality);
                filterapplied = CheckFilterApplied();
                if (federal_boundary != null && map.hasLayer(federal_boundary) && filterapplied == false) {
                    //////
                    map.removeLayer(federal_boundary);
                    map.removeLayer(label);
                }
                var boundary = $(this).attr('id');
                ////
                // if(boundary== 'Province_1'){
                boundaryy = boundary.split('_').join(' ');
                // }
                var federal_name = $(this).attr('data-fed');
                var layer_id = $(this).attr('data-id');
                var layer_request = $(this).attr('data-request');
                var name = $(this).html();
                // var geoname= $(this)
                //
                $('#fed_filterInput').val(name);
                //
                //

                // $.ajax({
                //   url: 'https://bipad.nepware.com/api/v1/municipality/?format=json&limit=20&search=',
                //   success: function(data) {fed_filterInput
                //
                //     }
                //
                //   });


                var fed_url = 'https://bipad.nepware.com/api/v1/' + federal_name + '/?format=geojson&' + layer_request + '=' + layer_id;
                var fed_mask_url = 'https://bipad.nepware.com/api/v1/' + layer_request + '/?format=geojson&search=' + boundaryy;

                var adjusted_name = name;
                // var adjusted_name = name.toLowerCase();
                var url_name = adjusted_name.replace(" ", "_");
                //

                if (name == "Province 2" || name == 'Gandaki' || name == 'Karnali') {
                    fed_mask_url = base_url + '/static/filter_geojson/' + url_name + '.geojson';
                    //

                } else {
                    //
                }

                //
                //

                /////
                ////
                label = L.layerGroup();
                federal_boundary = new L.geoJson.ajax(fed_url, {

                    onEachFeature: function (feature, layer) {
                        layer.setStyle({
                            fillColor: "blue",
                            fillOpacity: 0,
                            weight: 2,
                            opacity: 1,
                            color: '#a3b7e3',
                            //dashArray: '3'

                        });

                        var divIcon = L.divIcon({
                            html: "<span class='fed_labelText' style='color:blue;'>" + feature.properties.title + "</span>",
                            iconAnchor: [12, 0],
                        });
                        var fed_marker = L.marker(layer.getBounds().getCenter(), {
                            icon: divIcon
                        });
                        fed_marker.addTo(label);

                    },
                    pane: "baseLayerPane"

                });
                $.ajax({
                    // async:false,
                    url: fed_mask_url,
                    success: function (response) {
                        //
                        if (map.hasLayer(Mask)) {
                            map.removeLayer(Mask);
                        }
                        var prov_name = "Province 2" || name == 'Gandaki' || 'Karnali';
                        if (name == "Province 2" || name == 'Gandaki' || name == "Karnali") {
                            // var result= JSON.parse(result);
                            // var parsed_data = JSON.parse(response);
                            // //
                            // //
                            response = JSON.parse(response);
                        }

                        L.Mask = L.Polygon.extend({
                            options: {
                                stroke: false,
                                color: '#f6f6f4',
                                fillOpacity: 1,
                                clickable: true,
                                // zIndex:1000,
                                outerBounds: new L.LatLngBounds([-90, -360], [90, 360]),
                                pane: "maskPane",
                            },



                            initialize: function (latLngs, options) {

                                var outerBoundsLatLngs = [
                                    this.options.outerBounds.getSouthWest(),
                                    this.options.outerBounds.getNorthWest(),
                                    this.options.outerBounds.getNorthEast(),
                                    this.options.outerBounds.getSouthEast()
                                ];
                                L.Polygon.prototype.initialize.call(this, [outerBoundsLatLngs, latLngs], options);
                            },

                        });


                        L.mask = function (latLngs, options) {
                            return new L.Mask(latLngs, options);
                        };
                        //
                        if (name == 'Province 2' || name == 'Gandaki' || name == 'Karnali') {
                            // //

                            //
                            coordinates = response.geometry.coordinates[0][0];
                        } else {
                            //
                            coordinates = response.features[0].geometry.coordinates[0];
                        }

                        var latLngs = [];
                        for (i = 0; i < coordinates.length; i++) {
                            if (name == 'Province 2' || name == 'Gandaki' || name == 'Karnali') {
                                latLngs.push(new L.LatLng(coordinates[i][1], coordinates[i][0]));
                            } else {
                                for (j = 0; j < coordinates[i].length; j++) {
                                    // //
                                    latLngs.push(new L.LatLng(coordinates[i][j][1], coordinates[i][j][0]));
                                }
                            }
                        }

                        Mask = L.mask(latLngs);
                        //Mask.addTo(map).bringToFront();



                        map.addLayer(Mask);


                    }

                });

                // removeAllLayers();
                // map.removeLayer(Mask);
                // map.removeLayer(label);
                //  federal_maskboundary = new L.geoJson.ajax(fed_mask_url,{


                //  });
                // Varun mask Layer Start
                //removeAllLayers();


                // Varun mask Layer End

                ////
                // //
                //Varun Layer Mask Code Start

                //Varun Layer Mask Code End


                federal_boundary.on('data:loaded', function () {
                    //////
                    map.addLayer(federal_boundary);
                    //  map.addLayer(federal_maskboundary);
                    map.addLayer(label);
                    map.fitBounds(federal_boundary.getBounds());


                    map.removeLayer(vt_label_province);

                    if (map.hasLayer(district) || map.hasLayer(municipality)) {
                        map.removeLayer(label);
                    }

                    //map.removeLayer(vt_label_district);
                    // map.removeLayer(label);
                    //map.removeLayer(vt_label_municipality);


                    $('.loader').css('display', 'none');


                });
                //map.addLayer(district);
                var header_name = name.split(',')[0]
                $('.admin-level').html(header_name);

            });

            filterapplied = false;

            function CheckFilterApplied() {
                if (map.hasLayer(federal_boundary)) {

                    return true;
                } else {
                    return false;
                }
            }

            $('#fed_filterInput').on('keyup', function () {
                // ////
                var search_text = $(this).val();
                filter = search_text.toUpperCase();
                // ////
                $('.federal').css('display', 'none');
                var li = document.getElementsByClassName('federal');
                //  ////
                // ////
                //  $('#federal_boundary').html("");
                for (i = 0; i < li.length; i++) {
                    // a = h6[i].getElementsByTagName("a")[0];
                    //////


                    if (((li[i].id).replace("_", " ")).toUpperCase().indexOf(filter) > -1) {
                        //////

                        $("#" + li[i].id).css('display', '');
                    } else {
                        // ////

                        $("#" + li[i].id).css('display', 'none');
                    }
                }



                if ($.trim(search_text).length == 0) {
                    $('.admin-level').html("National");
                    // if (map.hasLayer(Mask)) {
                    //
                    if (map.hasLayer(Mask)) {
                        map.removeLayer(Mask);
                        map.removeLayer(label);
                        map.removeLayer(federal_boundary);
                    }
                    // removeAllLayers();
                    // map.addLayer(vt_label_province);
                    map.setView([28.410728397237914, 84.4024658203125], 7);
                    // map.removeLayer(Mask);
                    // }
                }

            });
            //end
            $('.osm_layer').on('click', function () {
                //////
                var layername = eval($(this).attr('data-layername'));
                //////
                if (map.hasLayer(layername)) {
                    map.removeLayer(layername);
                } else {
                    map.addLayer(layername);
                }

            });

            // type head js

            // end

            //VARUN START 

            // $(".custom-control-input hazard_list").on('click',function(){

            //   var value=""
            // });

            // if($(".custom-control-input hazard_list").prop('checked') == true){
            //     //do something
            //     //

            // }
            // var checkedValue = document.querySelector('.custom-control-input:checked').value;
            //   //

            //VARUN END

            //VARUN START 

            // $(".custom-control-input hazard_list").on('click',function(){

            $('#mapid').on('click', function () {
                $('.filter-listing').hide();
            });

            $('.leaflet-draw').attr('title', 'Start drawing on the map to filter active layers.')
            $(".filter_close").on("click", function () {
                $(this)
                    .closest(".filterSelect")
                    .find(".filter-listing")
                    .hide();
                $(".federal").css("display", "");
                $("#fed_filterInput").val("");

                //filterapplied= CheckFilterApplied();
                if (map.hasLayer(federal_boundary)) {
                    // map.removeLayer(federal_boundary);
                    // map.removeLayer(label);
                    // map.removeLayer(Mask);
                    $(".admin-level").html("National");

                    // map.addLayer(vt_label_province);
                }
                removeAllLayers();
                map.addLayer(province);
                map.addLayer(vt_label_province);
                map.removeLayer(label);

                map.setView([28.410728397237914, 84.4024658203125], 7);
            });
        }); //document end
    </script>

    <!-- <script src="{% static 'mappage/js/range-slider.js' %}"></script> -->
</body>

</html>